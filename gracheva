


\documentclass[12pt,twoside]{article}
\usepackage{jmlda}
\newcommand{\hdir}{.}
\setcounter{page}{1677}

%\NOREVIEWERNOTES
\title
    [Быстрые алгоритмы обработки изображений] % Краткое название; не нужно, если полное название влезает в~колонтитул
    {Быстрые алгоритмы обработки изображений на~основе гамма-нормальной модели скрытого поля}
\author
    {И.\,А. Грачева, А.\,В. Копылов} % основной список авторов, выводимый в оглавление
\thanks
    {Работа выполнена при финансовой поддержке РФФИ, проект \No\,13-07-00529.}
\email
    {gia1509@mail.ru, And.Kopylov@gmail.com}
\organization
    {Тульский государственный университет, Тула, Россия}
\abstract
    {В рамках байесовского подхода к проблеме обработки изображений задача
восстановления может быть выражена как задача поиска скрытой марковской
компоненты двухкомпонентного случайного поля, роль наблюдаемой компоненты
которого играет анализируемое изображение. Однако для некоторых типов задач
обработки изображений, таких как удаление тумана на изображении, сжатие
контраста HDR (high dynamic range)
изображений, восстановление структуры изображения, такая постановка задачи не подходит. В данной работе предлагается расширение постановки задач при байесовском подходе
к~проб\-ле\-ме обработки изображений.

\bigskip
\noindent
\textbf{Ключевые слова}: \emph {удаление тумана на изображении;
сжатие контраста HDR изображений; гамма-нормальная модель скрытого поля}
}
\titleEng
    {Fast image processing algorithms based~on~the~gamma-normal model of~hidden field}
\authorEng
    {I.\,A. Gracheva and A.\,V. Kopylov}
\organizationEng
    {Tula State University, Tula, Russia}
\abstractEng
{
\noindent
Within the Bayesian approach, the problem of reconstruction can be expressed
as the problem of finding the hidden Markov component of random field of
two-component, where \mbox{observed} component is the analyzed image. However,
for certain types of image processing problems,
such as image haze removal, HDR (high dynamic range) image compression,
structure-transferring of image, this formulation of the
problem is not the solution.  In this paper,  an extension of  the
problem formulations at the Bayesian approach to the problem of image processing.

    \noindent
    \textbf{Keywords}: \emph{image haze removal; HDR image compression; gamma-normal model of hidden field}
}

\begin{document}
\maketitle

\section{Введение}
Предварительная обработка является важным этапом в работе практически любой системы анализа изображений или компьютерного зрения. Данный этап играет ключевую роль в повышении качества дальнейшего анализа и интерпретации данных. Задачей обработки изображения может быть как улучшение (восстановление, реставрация) изображения по какому-то определенному критерию, так и специальное преобразование, кардинально меняющее изображение. Примерами обработки изображений могут служить повышение контраста, резкости, коррекция цветов, сглаживание, сжатие контраста, выделение границ объектов, удаление тумана или шума.

Принятый в данной работе байесовский подход часто используется как
универсальный метод для целого класса задач обработки изображений.
Результат обработки в~этом случае может быть представлен как преобразование
исходного изображения, определенного на дискретном множестве, во вторичный
массив данных, который определен на том же множестве аргументов и~принимает
значения из некоторого подходящего множества, в~зависимости от решаемой задачи.
Анализируемое изображение и~результат обработки в~рамках данного подхода
рас\-смат\-ри\-ва\-ют\-ся как наблюдаемая и~скрытая компоненты двухкомпонентного
случайного поля. Гамма-нормальная модель скрытого поля, предложенная
в~работе~\cite{Gracheva}, хорошо показала себя в~задаче удаления шума на изображении. Однако для таких задач, как удаление тумана на изображении, сжатие контраста HDR изображений, восстановление структуры изображения, данная постановка не подходит.

В настоящее время удаление тумана с изображений является важной задачей,
так как объекты на изображениях, сделанных в условиях дымки или тумана,
плохо различимы. Для дальнейшей работы с такими изображениями требуется
увеличить их контрастность и~улучшить цветопередачу. Часто требуется улучшить
качество не одного изображения, а~целого набора изображений, причем в~режиме
реального времени. Современные методы удаления тумана~\cite{Tan,Kratz,Kaiming}
строятся на различных предположениях о~глубине текстуры или цвета на
изображении. Однако все эти методы слишком медленные и~не могут обрабатывать
большие потоки данных в режиме реального времени.

Видение реального мира в нашей повседневной жизни часто имеет очень широкий
диапазон значений яркости. Зрительная система человека способна воспринимать
сцены с~динамическим диапазоном свыше пяти порядков и может постепенно
адаптироваться к~сценам с динамическим диапазоном свыше девяти порядков.
В~цифровой обработке изображений такие сцены получаются при использовании
технологии HDR~\cite{Aggarwal}. HDR изображения имеют много преимуществ по
сравнению со стандартными изображениями и~являются чрезвычайно полезными
в~некоторых приложениях. Тем не менее отображение HDR изображения представляет
собой сложную задачу, потому что динамический диапазон различных устройств
отображения (мониторы, принтеры и~др.)\ намного меньше, чем динамический
диапазон, обычно встречающийся в~реальных сценах. Таким образом, возникает
задача сжатия HDR изображений при максимальном сохранении их визуального содержимого.

В рамках данной работы оценивание скрытого случайного поля происходит по некоторому изображению, специфичному для каждой конкретной задачи. Например, в задаче удаления тумана в роли такого изображения выступает карта рассеивания, в задаче сжатия контраста --- слабоконтрастное изображение, в задаче восстановления структуры --- грубая оценка границы. Результирующее изображение получается путем уточнения этого исходного изображения с помощью оценок параметров модели скрытого поля, найденных с учетом управляющего изображения, в роли которого может выступать исходное анализируемое изображение.


\section{Нестационарная гамма-нормальная модель скрытого случайного поля}

Как уже отмечалось ранее, при расширенной постановки задачи восстановления
изображений при байесовском подходе оценивание скрытой марковской компоненты
$X=({{x}_{t}},t=1,\ldots,N)$, $T=\{t=({{t}_{1}},{{t}_{2}}):{{t}_{1}}=1,\ldots,{{N}_{1}},{{t}_{2}}=
1,\ldots,{{N}_{2}}\}$ происходит не по одному наблюдаемому изображению
$Y=({{y}_{t}},t\in T)$, как это было в задаче удаления шума на
изображении~\cite{Gracheva}, а~еще и~по некоторому изображению
$Y^{g}=({{y}^{g}_{t}},t\hm\in T)$, специфичному для каждой конкретной задачи.
Вероятностные свойства двухкомпонентного случайного поля $(X,Y)$
пол\-ностью определяются совместной условной плотностью вероятности ${\Phi (Y|X,\delta )}$ исходной функции $Y=({{y}_{t}},t\in T)$ по отношению к скрытой последовательности $X=({{x}_{t}},t\in T)$, и совместным априорным распределением ${\Psi (X|\Lambda ,\delta )}$ скрытой последовательности $X=({{x}_{t}},t\in T)$.

Совместная условная плотность вероятности ${\Phi (Y|X,\delta )}$
имеет вид Гауссовского распределения:
\begin{equation}\label{1}
  \Phi (Y|X,\delta )=\frac{1}{{{\delta }^{N/2}}{{(2\pi )}^{N/2}}}\exp
\left(-\frac{1}{2\delta }\sum\limits_{t\in T}^{}{{{({{y}_{t}}-{{x}_{t}})}^{2}}}\right),
\end{equation}
где $E(e_{t}^{2})=\delta $~--- дисперсия шума в наблюдении, которая считается неизвестной.

В данной работе  не используются преобразования, стабилизирующие дисперсию
так, чтобы шум становился приблизительно Гауссовским с~постоянной дисперсией.
Наоборот, предполагается, что общая дисперсия независимых компонент шума
модели изменяется $E({{\xi }_{t}}^2)={{r}_{t}}$. Неизвестные дисперсии
$({{r}_{t}},t\in T)$ считаются пропорциональными дисперсии шума
в~наблюдении ${{r}_{t}}={{\lambda }_{t}}\delta $ с~коэффициентами
пропорциональности ${{\lambda }_{t}}$, действующими как факторы
неизвестного мгновенного изменения скрытой компоненты $X=({{x}_{t}},t\in T)$,
которые также неизвестны.

В соответствии с этим предположением совместное априорное распределение оценок
скрытой последовательности $X=({{x}_{t}},t\in T)$ условно нормально по
отношению к~по\-сле\-до\-ва\-тель\-ности факторов ${\Lambda =({{\lambda }_{t}},t\in T)}$.
Таким образом, приходим к~совместному априорному распределению вида:
\begin{equation*}
   \Psi (X|\Lambda ,\delta )\propto \frac{1}{{{\left( \prod\limits_{t\in T}{\delta {{\lambda }_{t}}} \right)}^{1/2}}{{(2\pi )}^{n(N-1)/2}}}
 \exp \left( -\frac{1}{2}\sum\limits_{t',t''\in V}^{{}}{\frac{1}{\delta {{\lambda }_{t}}}{{({{x}_{t'}}-{{x}_{t''}})}^{2}}} \right),
\end{equation*}
где V --- граф соседства элементов изображения, имеющий вид решетки.

Наконец, предположим, что обратные факторы $1/{{\lambda }_{t}}$ должны быть априори независимы и~одинаково гамма-распределены
\begin{equation*} %\label{3}
  \gamma \left(\frac{1}{\lambda_{t}}\Big\vert \delta ,\lambda ,\mu \right)
\propto
{\left(\frac{1}{\lambda_{t}}\right)}^{(2\mu +1)/(2\delta \mu )}\exp
\left( -\frac{\lambda }{2\delta \mu }\,\frac{1}{\lambda_{t}} \right),
\end{equation*}
на положительной полуоси ${{\lambda }_{t}}\ge 0$.
Математическое ожидание и дисперсия гамма-распределения вычисляются как
\[
  E\left(\frac{1}{\lambda_{t}}\right)=\frac{(1+\delta )\mu +1}{\lambda}\,;
\quad \mathrm{Var}\left(\frac{1}{\lambda_{t}}\right)=2\delta \mu \frac{(1+\delta )\mu +1}{{{\lambda }^{2}}}.
\]

Независимые априорные распределения каждого мгновенно обработанного
фактора $1/{{\lambda }_{t}}$ почти полностью сконцентрированы вокруг
математического ожидания $1/\lambda$, если ${\mu \to 0}$. При
${\mu \to \infty}$ коэффициент $1/\lambda $ имеет тенденцию к~почти
равномерному распределению. Таким образом, приходим к~априорной плотности распределения вида:
\begin{equation*} %\label{4}
  G(\Lambda |\delta ,\lambda ,\mu )=\exp \left[ -\frac{1}{2\delta \mu }\sum\limits_{t\in T}{\left( \lambda \frac{1}{{{\lambda }_{t}}}+\frac{1}{\lambda }\ln {{\lambda }_{t}} \right)} \right]\,.
\end{equation*}
Совместное априорное нормальное гамма-распределение обоих последовательностей $X=({{x}_{t}},t\in T)$ и ${\Lambda =({{\lambda }_{t}},t\in T)}$ имеет вид:
\[
  H(X,\Lambda |\delta ,\lambda ,\mu )=\Psi (X|\Lambda ,\delta )G(\Lambda |\delta ,\lambda ,\mu )\,.
\]

В сочетании с совместной условной плотностью вероятности~(1) это дает основу для байесовского оценивания скрытой последовательности $X=({{x}_{t}},t\in T)$.

Байесовские оценки независимы от дисперсии шума в наблюдениях ${\delta}$:
\begin{equation}
\left.
\left\{
\begin{array}{rl}
    (\hat{X},\hat{\Lambda }|\lambda ,\mu )&={\arg \min }_{X,\Lambda }J(X,\Lambda |Y,\lambda ,\mu )\,; \\[6pt]
     J(X,\Lambda |Y,\lambda ,\mu )&=\displaystyle
\sum\limits_{t\in T}{{{({{y}_{t}}-{{x}_{t}})}^{2}}}+
\sum\limits_{t',t''\in V}^{{}}{\left\{
\frac{1}{{{\lambda }_{t}}}\left[ {{({{x}_{t'}}-{{x}_{t''}})}^{2}}+
\frac{\lambda}{\mu}  \right]+\left(1+\frac{1}{\mu}\right )\ln {{\lambda }_{t}} \right\}.}
  \end{array}
\label{5-a}
\end{equation}

Растущее значение параметра ${\mu}$ наделяет этот критерий выраженной
склон\-ностью к~сохранению большинства оценок факторов ${\hat{\lambda}_{t}}$,
находящихся близко к~значению~${\lambda}$, и~допускает большие разрывы, открывая
тем самым скрытые события в~первую очередь гладкости исходной последовательности.

Условно оптимальные факторы ${\hat{\Lambda }(X,\lambda ,\mu )=[\hat{{\lambda }_{t}}(X,\lambda ,\mu ),t\in T]}$ определяются независимо друг от друга:
\begin{equation*}
   {\hat{\Lambda }(X,\lambda ,\mu )={\arg \min }_{\Lambda }J(\Lambda |X,\lambda ,\mu ):}\
  \frac{\partial }{\partial {{\lambda }_{t}}}\left\lbrace
\frac{1}{{{\lambda }_{t}}}
\left[{{({{x}_{t'}}-{{x}_{t''}})}^{2}}+\frac{\lambda}{\mu} \right]+
\left(1+\frac{1}{\mu} \right)\ln {{\lambda }_{t}} \right\rbrace =0\,.
\end{equation*}

Нулевые условия для производных, за исключением тривиальных решений ${{\lambda }_{t}}\to \infty $, приводят к равенству
\begin{equation}\label{7-a}
  \hat{{\lambda }_{t}}(X,\lambda ,\mu )=\lambda \frac{(1/\lambda ){{({{x}_{t'}}-{{x}_{t''}})}^{2}}+1/\mu }{1+1/\mu }\,.
\end{equation}\par

\begin{figure}[b!]   %fig1
\center{\includegraphics[height=6.2cm]{\hdir/Figure_1}}
\caption{«Эффект насыщения» из-за штрафа при достаточно большом значении параметра~${\mu}$ и~фиксированном значении ${\lambda}=1$}
\label{fg:Fig1}
\end{figure}

Подстановка~(\ref{7-a}) в~(\ref{5-a}) дает эквивалентную форму, которая позволяет избежать немедленного нахождения самих факторов:
\begin{equation}
  \left.
  \left\{
\begin{array}{rl}
     (\hat{X},\hat{\Lambda }|\lambda ,\mu )&={\arg \min }_{X,\Lambda }J(X,\Lambda |Y,\lambda ,\mu ); \\[6pt]
     J(X,\Lambda |Y,\lambda ,\mu )&=
\displaystyle \sum\limits_{t\in T}{{{({{y}_{t}}-{{x}_{t}})}^{2}}}+
\sum\limits_{t',t''\in V}^{{}}\left\{ \left(1+\frac{1}{\mu} \right)\ln \frac{(1/\lambda ){{({{x}_{t'}}-{{x}_{t''}})}^{2}}+1/\mu }{1+1/\mu } \right\}.
  \end{array}
\label{8-a}
\end{equation}
Это квадратичная в непосредственной близости от нулевой точки функция
${{{({{x}_{t'}}-{{x}_{t''}})}^{2}}=0}$ и остается таковой практически на всей числовой оси, если значение ${\mu}$ достаточно мало, как показано на рис.~\ref{fg:Fig1}.
Но при росте ${\mu}$ первоначальный квадратичный штраф подвергается все более
заметному влиянию насыщения на некотором расстоянии от нуля. Это означает,
что критерий сильно наказывает оценки исходной функции, но становится более
снисходительным к~резким разрывам.

\section{Алгоритм удаления тумана на изображении}

Удаление тумана на изображении является проблемой, которая требует метода
вывода или предварительных знаний о сцене. Количество тумана, наблюдаемого на изображении, зависит от расстояния объекта до камеры,
длины волны света и~размера рассеивающих частиц в атмосфере. Учитывая местоположение туманного пикселя $t\in T$ на изображении  $Y=({{y}_{t}},t\in T)$, $Y\in R^3$, обработанный пиксель изображения без тумана $X=({{x}_{t}},t\in T)$, $X\in R^3$ связан с туманной версией изображения через модель атмосферного рассеивания~\cite{Kristofor}
\begin{equation}\label{9-a}
  {y}_{t} = \mathrm{map}_{t}{x}_{t} + (1 - \mathrm{map}_{t})a\,,
\end{equation}
где $a\in R^3$ --- атмосферный свет; $\mathrm{Map}=({\mathrm{map}_{t}},t\in T)$,
$\mathrm{Map}\in R^3$,~--- карта светопередачи (средство передачи части света, который не рассеялся и достиг камеры).

Начнем с предположения о том, как оценить значение атмосферного света $a\in R^3$. В большинстве методов удаления тумана с изображений в качестве атмосферного света используется пиксель с самой высокой интенсивностью. Но на реальных изображениях самый яркий пиксель может находиться на белом автомобиле или белом здании.

В данной работе будем использовать темный канал для улучшения оценки атмосферного света \cite{Aggarwal}. Темный канал основан на наблюдении о затемнении исходного изображения. Изображение темного канала как раз и будет играть роль дополнительного изображения $Y^{g}=({{y}^{g}_{t}},t\in T)$. Для получения темного канала разбиваем исходное изображение на блоки любого размера (чем больше размер блока, тем более затемненным будет изображение; оптимальным является размер
$5\times5$). В большинстве таких блоков некоторые пиксели, так называемые темные пиксели, имеют очень низкую интенсивность, по крайней мере, одного из трех цветовых компонент (RGB). Низкие интенсивности в темном канале возникают в основном из-за трех факторов: теней; красочных предметов или поверхностей, которым не хватает цвета в любом из трех цветовых компонент (RGB); темные объекты или поверхности, например
темный ствол дерева. Таким образом, для исходного изображения $Y=({{y}_{t}},t\in T)$
\begin{equation}\label{10-a}
  {y}^{\mathrm{g}}_{t} = {\min}_{c\in (r,g,b)}({\min}_{j\in {\Omega}\left( t \right)}({y}^{c}_{j})),
\end{equation}
где $Y^{\mathrm{g}}=({{y}^{\mathrm{dark}}_{t}},t\in T)$ --- темный канал
изображения $Y=({{y}_{t}},t\in T)$; $y^{c}$~---
значение цветового канала изображения $Y=({{y}_{t}},t\in T)$;
 ${\Omega}\left( t \right)$ --- локальный блок с центром в~$t$.

Это наблюдение говорит, что в некотором блоке интенсивность низка и, как
правило, равна нулю, если ${y}_{t}$ представляет собой затемненный пиксель на исходном изображении. Таким образом, эти темные пиксели могут обеспечить точную оценку туманных пикселей на изображении.

Для получения значений атмосферного света по каждому из трех цветовых
компонент (RGB) выбираем первые 0,1\% самых ярких пикселей в~темном канале.
Среди этих пикселей значения пикселей с самой высокой интенсивностью по каждому из трех цветовых компонент на исходном изображении выбираются в качестве атмосферного света.
Следует отметить, что эти пиксели могут быть не самыми яркими на исходном изображении. Этот простой метод, основанный на темном канале, более надежен, чем метод «яркого пикселя».
Следующим шагом является получение карты светопередачи
$\mathrm{Map}=({\mathrm{map}_{t}},t\in T)$,
\begin{equation}\label{11-a}
  \mathrm{map}_{t} = 1 - \omega\hat{\lambda}_{t},
\end{equation}
где $\omega$ --- коэффициент уровня белого (эмпирическим путем было выявлено,
что оптимальное значение коэффициента $\omega=0{,}9$),
а~$\hat{\lambda}_{t}$ найдены по~(\ref{7-a})
в~результате одной итерации процедуры Гаусса--Зайделя.

И, наконец, найдя все необходимые параметры из~(\ref{10-a}) и~(\ref{11-a}),
получаем изображение без тумана из~(\ref{9-a})
\begin{equation*} %\label{11}
  {x}_{t} = \frac{{y}_{t} - a}{\mathrm{map}_{t}} + a\,.
\end{equation*}

Данный алгоритм имеет линейную вычислительную сложность относительно размера анализируемого изображения.

\section{Алгоритм сжатия контраста HDR изображений}

Предлагаемый в данной работе алгоритм --- это попытка математически
имитировать известную художественную технику для создания сцены
с~высокой контрастностью. \mbox{Когда} художники создают живопись, они
пытаются охватить внешний вид «грубой» последовательностью границ и~теней.
Многие начинают с~эскиза крупных, важных особенностей сюжета, а~затем
постепенно добавляют более тонкие детали. Первоначальные эскизы содержат
четко определяемые границы вокруг больших, плавно затененных областей с~высокой
контрастностью и~наиболее важными особенностями сцены. Далее художник добавляет
больше оттенков и~границ, чтобы создать более мелкие детали, заполняющие
визуально пустые области. Этот метод особенно хорошо работает для сюжетов
с~высокой детализацией, так как это позволяет настроить отдельные настройки
контрастности на каждом этапе с~по\-мощью увеличения детализации. Художник
может также подчеркнуть или заглушить некоторые компоненты сцены, чтобы
контролировать их видимость и~обратить внимание зрителя на них.

Также предлагаемый подход опирается на широко распространенное допущение,
что зрительная система человека не очень чувствительна к абсолютным яркостям,
достига\-ющим сетчатки, а с учетом местных изменений соотношений интенсивностей
это уменьшает эффект глобальных различий, которые могут быть связаны
с~различиями в освещении~\cite{DiCarlo}. Алгоритм основан на использовании
нестационарной гамма-нормальной модели в рамках байесовского подхода
к~проблеме обработки изображений, описанной в~разд.~1. Точно так же, как
и~для решения задачи удаления шума на изображении, можно оценить
значения скрытого поля в соответствии с~(\ref{7-a}) и~(\ref{8-a}),
используя процедуру Гаусса--Зайделя и процедуру фильтрации-интерполяции Камана, получая тем самым промежуточное слабоконтрастное изображение $Y^g=({{y}^{g}_{t}},t\in T)$.
А~затем для сжатия контраста HDR изображений применяем простую процедуру пересчета элементов изображения:
\begin{equation*} %\label{12}
  {x}_{t}={y}_{t}-\alpha \left({y}^{g}_{t}+\mathrm{mean}\left({y}^{g}\right)\right),
\end{equation*}
где $X=({{x}_{t}},t\in T)$~--- результат сжатия контраста исходного HDR
изображения; $Y=({{y}_{t}},t\in T)$~--- анализируемое HDR изображение;
$Y^g=({{y}^{g}_{t}},t\in T)$~--- промежуточное слабоконтрастное изображение;
$\alpha$~--- масштабирующий коэффициент; $\mathrm{mean}\left({y}^{g}\right)$~---
среднее значение интенсивности слабоконтрастного изображения.

В результате любое резкое изменение яркости высокого динамического диапазона
изображения порождает увеличение значения яркости дисперсии шума.
С~другой стороны, мелкие детали, такие как текстуры, соответствуют дисперсии
шума гораздо меньшей величины. Б\'{о}льшие значения дисперсии шума критерий наказывает в большей степени, чем мелкие, таким образом, сжимая кардинальные изменения яркости, сохраняя мельчайшие детали.

\section{Экспериментальные результаты}

Результаты по удалению тумана с изображений, представленные на рис.~\ref{fg:Fig2}, показывают, что предложенный метод достигает хорошего восстановления контраста и цветопередачи, в результате чего происходит значительное улучшение видимости объектов на изображении. А высокая скорость работы алгоритма позволит обрабатывать поток изображений
в~режиме реального времени.


Разработанная процедура имитирует схему технологического процесса художника
в~обратном направлении~--- избирательно удаляет детали из сцены, оставляя
только плавно затененные области, разделенные резкими границами. Можно
легко восстановить удаленные детали путем вычитания сглаженного изображения
из исходного. А затем, следуя схеме прорисовки деталей,
которую используют художники, повысить контраст, как показано на рис.~\ref{fg:Fig3}.


\begin{figure}[b!] %fig2
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_2}} а) \\
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_3}} \\б)
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_4}} \\в)
	\end{minipage}
	\vfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_5}} г) \\
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_6}} д) \\
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_7}} \\е)
	\end{minipage}
	\caption{Результаты удаления тумана на изображении Forest $800\times600$:
(а)~исходное изображение; (б)~выделение темного канала на исходном изображении;
(в)~границы объектов на исходном изображении; (г)~карта светопередачи;
(д)~результат удаления тумана предложенным способом;
(е)~результат удаления тумана методом~\cite{Kaiming}}
	\label{fg:Fig2}
\end{figure}\par


В зависимости от степени сглаживания изображения и значения масштабирующего коэффициента регулируется степень детализации изображений.
\begin{figure}[h!] %fig3
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_8}} а) \\
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_9}} \\б)
	\end{minipage}
	\hfill
	\begin{minipage}[h!]{0.31\linewidth}
		\center{\includegraphics[width=1\linewidth]{\hdir/Figure_10}} \\в)
	\end{minipage}
	\caption{Результаты сжатия контраста HDR изображения:
(а)~исходное изображение; (б)~сжатие контраста исходного изображении при
$\alpha = 0{,}8$; (в)~сжатие контраста исходного изображении при $\alpha = 0{,}5$ }
	\label{fg:Fig3}
\end{figure}


\section{Заключение}

Применение нестационарной гамма-нормальной модели позволило разработать эффективные алгоритмы решения поставленных задач на основе процедуры Гаусса--Зайделя. Граф смежности элементов изображения представляется в виде решетки и затем аппроксимируется последовательностью деревьев, каждое из которых связано с отдельным столбцом изображения. Оценивание скрытых переменных вторичного массива данных в каждом дереве осуществляется за счет процедуры фильтрации-интерполяции Калмана, что позволяет достичь линейной зависимости времени работы алгоритма от размера исходного изображения.

%\bibliography{Bibliograf}
\renewcommand{\bibname}{Литература}
\begin{thebibliography}{1}
\bibitem{Gracheva}
    \BibAuthor{Грачева\;И.\,А., Копылов\;А.\,В., Красоткина\;О.\,В.}
{Адаптивная процедура обобщенного сглаживания изображений на основе
статистического подхода}~//
{Известия ТулГУ. Технические науки}, 2014. Вып.~11. \No\,1. С.~390--401.
\bibitem{Tan}
    \BibAuthor{Tan\;K., Oakley\;P.\,J.}
{Physics-based approach to color image enhancement in poor visibility
conditions}~//
{Optical Society of America}, 2001. Vol.~18. P.~2460--2467.
\bibitem{Kratz}
    \BibAuthor{Kratz\;L., Nishino\;K.}
{Factorizing scene albedo and depth from a single foggy image}~//
{IEEE  Conference (International) on Computer Vision (ICCV)}, 2009. P.~1701--1708.
\bibitem{Kaiming}
    \BibAuthor{Kaiming\;H., Jian\;S., Xiaoou\;T.}
{Single image haze removal using dark channel prior}~//
{IEEE Conference (International) on Computer Vision and Pattern Recognition
(CVPR)}, 2009. P.~1956--1963.
\bibitem{Aggarwal}
    \BibAuthor{Aggarwal\;M., Huja\;A.}
{High dynamic range panoramic imaging}~//
{IEEE Conference (International) on Computer Vision (ICCV)}, 2009. Vol.~1. P.\,2--9.
\bibitem{Kristofor}
    \BibAuthor{Kristofor\;B., Gibson\;B., Truong\;Q.\,N.}
{Fast single image fog removal using the adaptive Wiener filter}~//
    {Conference (International) on Information Processing (ICIP)}, 2013.
\bibitem{DiCarlo}
    \BibAuthor{DiCarlo\;J., Wandell\;B.}
{Rendering high dynamic range images}~//
{SPIE Electronic Imaging '2000 Conference Proceedings}, 2000. Vol.~3965. P.~392--401.
\end{thebibliography}

\renewcommand{\bibname}{References}
\begin{thebibliography}{1}
\bibitem{Gracheva}
{Gracheva, I.\,A., A.\,V.~Kopylov, and O.\,V.~Krasotkina.}
2014.  {Adaptive procedure for generalized smoothing of images on
the basis of statistical approach}.
    \BibJournal{News of the Tula State University. Technical Sciences}
11(1):390--401.
\bibitem{Tan}
{Tan, K., and P.\,J.~Oakley.}
2001. {Physics-based approach to color image enhancement in poor visibility conditions.}
    \BibJournal{Optical Society of America} 18:2460--2467.
\bibitem{Kratz}
    {Kratz,~L., and K.~Nishino.} 2009.
{Factorizing scene albedo and depth from a single foggy image.}
    \BibJournal{IEEE  Conference (International) on Computer Vision (ICCV)}.
1701--1708.
\bibitem{Kaiming}
{Kaiming,~H., S.~Jian, and T.~Xiaoou.} 2009.
{Single image haze removal using dark channel prior}.
    \BibJournal{IEEE Conference (International)
 on Computer Vision and Pattern Recognition (CVPR)}. 1956--1963.
\bibitem{Aggarwal}
{Aggarwal,~M., and A.~Huja.} 2009.
{High dynamic range panoramic imaging.}
    \BibJournal{IEEE  Conference (International)
on Computer Vision (ICCV)} 1:2--9.
\bibitem{Kristofor}
{Kristofor,~B., V.~Gibson, and Q.\,N.~Truong.} 2013.
{Fast single image fog removal using the adaptive Wiener filter.}
    \BibJournal{Conference (International)
on Information Processing (ICIP)}.
\bibitem{DiCarlo}
{DiCarlo,~J., and B.~Wandell.} 2000.
{Rendering high dynamic range images.}
    \BibJournal{SPIE Electronic Imaging '2000 Conference (Proceedings)}.
3965:392--401.
\end{thebibliography}
% Решение Программного Комитета:
%\ACCEPTNOTE
%\AMENDNOTE
%\REJECTNOTE
\end{document}

