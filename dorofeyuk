\documentclass[12pt,twoside]{article}
\usepackage{jmlda}
\setcounter{page}{1439}

%\NOREVIEWERNOTES
\title
    [Математическое моделирование универсальной характеристики] % Краткое название; не нужно, если полное название влезает в~колонтитул
    {Математическое моделирование универсальной характеристики поворотно-лопастной гидротурбины}
\author
    [Волков~Ю.\,С.] % список авторов для колонтитула; не нужен, если основной список влезает в колонтитул
    {Волков~Ю.\,С., Мирошниченко~В.\,Л., Салиенко~А.\,Е.} % основной список авторов, выводимый в оглавление
    [Волков~Ю.\,С.$^1$, Мирошниченко~В.\,Л.$^1$, Салиенко~А.\,Е.$^2$] % список авторов, выводимый в заголовок; не нужен, если он не отличается от основного
\thanks
    {Работа выполнена при финансовой поддержке программы фундаментальных исследований совместных интеграционных проектов
    СО РАН и УрО РАН, проект \No\,32, и при поддержке РФФИ, грант \No\,15-07-07530.}
\email
    {volkov@math.nsc.ru, miroshn@math.nsc.ru, sa\_cae@yahoo.com}
\organization
    {$^1$Институт математики им. С.Л. Соболева СО РАН, Новосибирск;
    $^2$ОАО «ТЯЖМАШ», Сызрань}
\abstract
    {Рассматривается задача о построении универсальной характеристики рабочего колеса поворотно-лопастной
    гидротурбины по результатам энергетических испытаний модельной турбины.
    Универсальная характеристика является основным документом для выбора параметров натурной гидравлической турбины (диаметр рабочего колеса, частота вращения и др.), которые гарантируют наиболее эффективную работу турбины при всех режимах её эксплуатации на конкретной ГЭС. Даётся описание математического аппарата,
    применённого для создания математической модели универсальной характеристики рабочего колеса поворотно-лопастной
    гидротурбины по результатам стендовых энергетических испытаний модельной турбины.
    В основе предложенного подхода лежат методы аппроксимации многомерных функций по хаотически
    разбросанным данным, созданные авторами путём модификации и обощения $D^m$-сплайнов и мультквадриков Харди.
    Приводится пример моделирования по реальным данным на основе созданного комплекса программ.

\bigskip
\textbf{Ключевые слова}: \emph {универсальная характеристика, поворотно-лопастная гидротурбина,
КПД, сплайн, аппроксимация}.}

\titleEng
    {Mathematical modeling of hill diagram for Kaplan turbine}
\authorEng
    {Volkov~Yu.\,S.$^1$, Miroshnichenko~V.\,L.$^1$, Salienko~A.\,E.$^2$}
\organizationEng
    {$^1$Sobolev Institute of Mathematics, Novosibirsk; $^2$JSC Tyazhmash, Syzran}
\abstractEng
    {
   \textbf{Background}: The problem of constructing of a hill diagram for the Kaplan
   turbine wheel on the power test results of the model turbine is considered. The hill diagram is the basic document for selection of full-scale hydraulic turbine parameters (turbine wheel diameter, rotating frequency, etc.) that ensure the most efficient perfomance of the turbine at all modes of its operation in a particular hydropower station.

   \textbf{Methods}: Building a description of the mathematical formalism applied to mathematical modeling of the hill diagram of the Kaplan turbine based on the power test results
   of the model turbine.

   \textbf{Results}: The basis of the proposed approach is the approximation
   methods for multidimensional functions at scattered data.
   The methods are modifications and generalizations of $D^m$-splines and Hardy's multiquadrics.
   An example of modeling for real data on the basis of the program complex is given.

   \textbf{Conclusions}: The software package for mathematical modeling
   of hill diagram for the Kaplan turbine was created. In the future it is planned to use this software package for main full-scale hydraulic turbine parameters selection in a hydropower station.

\textbf{Keywords}: \emph{hill diagram, Kaplan turbine, coefficient of efficiency, spline, approximation}.}


\begin{document}
\maketitle
%\linenumbers

\section{Введение}
Одной из важнейших задач в области энергетики является оптимальное проектирование
гидротурбин при строительстве гидроэлектрических станций.
На современном этапе развития науки построить адекватную математическую модель работы
гидротурбины с тем, чтобы провести оптимизацию, пока не представляется возможным.
Большой накопленный опыт, как правило, позволяет определиться с типом гидротурбин для каждого конкретного случая.
В настоящее время нашли распространение три основные системы турбин: радиально-осевые (РО),
поворотно-лопастные (ПЛ) и ковшевые. Гидротурбины одной системы могут отличаться размерами,
конструкцией механизмов, конфигурацией и относительными размерами проточного тракта,
определяющих тип турбин. Все эти различия определяют индивидуальные свойства,
главными из которых являются коэффициент полезного действия (КПД), быстроходность,
приведённые параметры и кавитационная характеристика. Основными элементами, определяющими эти свойства,
являются рабочее колесо, направляющий аппарат и отсасывающая труба.
Однако экспериментально установленный факт \cite{Orgo78}, что гидротурбины
одного типа, имеющие разные размеры, но геометрически подобный тракт, мало отличаются
по индивидуальным свойствам, позволяет всё исследование при проектировании натурных
ГЭС перенести на малые модельные турбины, изучение которых можно проводить
с использованием стендовых испытаний в заводских лабораториях.
В гидротурбинах одного типа, имеющих разные размеры и геометрически подобный проточный тракт,
перечисленные свойства могут несколько отличаться из-за влияния масштабного эффекта.

Параметры гидротурбин являются их количественными и качественными характеристиками.
При проектировании гидротурбин заданными параметрами являются: напор, расход и мощность.
Напор $H$ (м) определяется при проектировании установки и представляет собой энергию, которой располагает турбина.
Расход $Q$ (м$^3$/с) определяется также при проектировании ГЭС.
Мощность турбины $N$ (кВт) при заданных значениях $H$ и $Q$ называют номинальной.
Параметрами, определяемыми для выбора турбины, являются: частота вращения $n$ (об/мин) и диаметр рабочего колеса $D$ (м).

Диаметр рабочего колеса турбины $D$ является основным размером, определяющим при заданных напоре и
пропускной способности мощность и массу турбины. Гидродинамические качества рабочего колеса в основном
определяют такие характеристики турбины, как КПД, приведённые расход, частоту вращения,
кавитационный коэффициент и коэффициент быстроходности. Данные о турбине представляются в форме характеристик,
определяющих все необходимые показатели турбины для различных условий её работы, различных режимов.
Поскольку такие данные для натурной гидротурбины, устанавливаемой на ГЭС, получить заранее невозможно,
то их получают для подобной модельной турбины при её испытаниях и исследованиях на гидротурбинных стендах.
Затем, используя формулы пересчёта \cite{Orgo78, Barlit77, Krivchenko83}, учитывающие масштабный эффект, получают энергетические,
кавитационные и другие характеристики натурной турбины, выражающие зависимости КПД,
кавитационного коэффициента и других величин на различных режимах работы от основных параметров ($D$, $n$, $Q$, $H$).

Основным результатом лабораторных испытаний модельной гидротурбины является главная универсальная
характеристика или просто универсальная характеристика, представляющая зависимости КПД $\eta$,
величины открытия направляющего аппарата $a_0$ и кавитационного коэффициента $\sigma$
от приведённых величин частоты вращения $n'_I$ и расхода $Q'_I$.
Если турбина поворотно-лопастная, то присутствует ещё зависимость от угла поворота лопастей $\varphi$.
Нахождение таких зависимостей требуется существующими методиками выбора основных
параметров натурной гидротурбины.

Коэффициент полезного действия турбины $\eta$ определяется отношением мощности на валу турбины к мощности потока,
т.е. $N=\rho gQHn$. Здесь $\rho$ --– плотность воды, $g$ --– ускорение свободного падения.
Приведённые частота вращения и расход определяются формулами
\[
Q'_I=\frac{Q}{D^2\sqrt{H}}, \qquad  n'_I=\frac{nD}{\sqrt{H}}
\]
и выражают соответственно расход и частоту вращения условной турбины-эталона,
имеющей диаметр 1 м и работающей при напоре 1 м.
Значения приведённых параметров $n'_I$ и $Q'_I$ в подобных режимах практически сохраняются неизменными.

В работе рассматривается задача о построении универсальной характеристики рабочего колеса
поворотно-лопастной или ПЛ гидротурбины по результатам энергетических испытаний модельной гидротурбины на стенде.

В результате энергетических испытаний модельной турбины получается таблица чисел,
состоящая из величин угла поворота лопастей $\varphi$, открытия направляющего аппарата $a_0$,
приведённой частоты вращения турбины $n'_I$, приведённого расхода воды $Q'_I$ и КПД турбины $\eta$,
дополнительно могут содержаться значения кавитационного коэффициента $\sigma$ и каких-либо других функций.
Эти экспериментальные данные характеризуют зависимость КПД $\eta$ от угла поворота лопастей $\varphi$ и приведённых частоты $n'_I$ и расхода $Q'_I$.

Задача состоит в создании по имеющимся данным математической модели, позволяющей строить пропеллерную и
комбинаторную (универсальную) характеристики поворотно-лопастной гидравлической турбины и
выполнять типовые расчёты, связанные с использованием этих характеристик.

Насколько нам известно, данное исследование является первым в нашей стране
по построению математической модели универсальной характеристики ПЛ-гидротурбины
(ранее авторами была разработана математическая модель универсальной характеристики РО-турбины \cite{VM98}).
До недавнего времени единственным заводом в России по проектированию и
производству гидротурбин был ОАО <<Ленинградский металлический завод>>,
в сотрудничестве с инженерами которого и начиналось наше исследование.
Отметим, что попытки решения данной задачи с помощью известных программных
систем геометрического моделирования не увенчались успехом.

Специфика данных задачи состоит в том, что при проведении испытаний на стенде установочными параметрами
являются угол поворота лопастей, величина открытия направляющего аппарата и частота вращения турбины,
остальные измеряются или вычисляются. Как правило, имеются данные для небольшого количества углов
установки лопастей (3 –- 6). Для каждого угла $\varphi$ точки с координатами ($Q'_I$, $n'_I$) лежат на нескольких линиях,
соответствующих одинаковым значениям $a_0$, называемых линиями открытий. Хотя данные и лежат на линиях открытий,
однако в плоскости координат $Q'_I$ и $n'_I$ они представляют нерегулярный (разбросанный) набор точек,
в которых известны (с погрешностью) значения функции $\eta$ и, возможно, $\sigma$ или других функций.
Задача состоит в восстановлении функции $\eta$ как функции от переменных $Q'_I$, $n'_I$ и $\varphi$
(это пропеллерная характеристика) и функции $\eta$ как функции от переменных $Q'_I$ и $n'_I$,
являющейся огибающей семейства $\eta$ как функции от переменных $Q'_I$, $n'_I$ и $\varphi$,
т.е. пропеллерных характеристик, рассматриваемых как семейство по параметру $\varphi$ функций от $Q'_I$ и $n'_I$
(комбинаторная характеристика). Мы ограничимся рассмотрением восстановления функции $\eta$.

В рассматриваемой задаче восстановления функции КПД гидротурбины присутствует сильная неравномерность
расположения точек с данными, т.е. точки сконцентрированы вблизи некоторых линий и имеются точки,
очень близко лежащие друг к другу (из-за погрешности, возможно, даже с существенно различными значениями КПД),
и в то же время на достаточно больших участках (между линиями) точек нет совсем.
Такая специфика задачи указывает на неприемлемость использования методов аппроксимации по хаотически
расположенным данным, основанных на триангуляции области.
«Хорошими» методами для такой задачи нам представляются глобальные методы типа аппроксимации
$D^m$-сплайнами \cite{BezhaevVasilenko01,BKMV13,RSh13} или мультиквадриками Харди \cite{H90}.
А поскольку подобные аппроксиманты довольны сложны и трудно вычислимы (с большими затратами),
то решение последующих задач --– типовых расчётов, связанных с использованием полученных характеристик, --–
становится достаточно ресурснозатратным занятием. Поэтому далее такой аппроксимант,
построенный по хаотическим данным, имеет смысл заменить с нужной точностью кубическим сплайном
на регулярной (прямоугольной) сетке. Использование «регулярного» кубического сплайна вместо «хаотического» сплайна,
при сохранении всех достоинств последнего, позволяет значительно увеличить скорость проведения всех типовых расчётов,
связанных с использованием характеристик.

Такой двухшаговый метод мы применили для создания математической модели пропеллерной и комбинаторной
характеристики ПЛ-гидротурбины по результатам лабораторных испытаний модельных турбин на стенде.
Для реализации первого этапа аппроксимации мы использовали модифицированные $D^m$-сплайны, называемые нами DMM-сплайнами,
которые уже использовались для решения ряда других задач \cite{BKMV13,ABDMPS09} и
моделирования универсальной характеристики РО-гидротурбины \cite{VM98}.



\section{Постановка задачи}
Рассмотрим математическую постановку задачи аппроксимации. Имеются следующие исходные данные.
Для каждого угла поворота лопастей ПЛ-турбины $\varphi_k$, $k=1,\ldots,L$,
есть таблица чисел, строки которой образуют наборы чисел
\[
a_i, n_i, q_i, n_i, \quad i=1,\ldots,N_k,
\]
где $a_i$ --– значение открытия направляющего аппарата $a_0$ (в дальнейшем мы опускаем для краткости общепринятый индекс 0),
$n_i$ --– приведённая частота вращения $n'_I$, $q_i$ --– приведённый расход $Q'_I$
(у приведённых величин также для краткости опущены двойные индексы), $\eta_i$ --– КПД турбины $\eta$.
Данные известны с некоторой погрешностью.

Первым этапом моделирования универсальной характеристики является построение пропеллерной
характеристики $\eta(q,n,\varphi)$. Пропеллерную характеристику мы строим в параметрическом виде
\begin{equation} \label{1}
\left\{
\begin{array}{l}
\eta(a,n,\varphi),\\
q(a,n,\varphi).
\end{array}
\right.
\end{equation}
Каждая из функций $\eta$ и $q$ на первом шаге представляет собой сглаживающий DMM-сплайн
от трёх переменных $a,n,\varphi$, построенный по дискретным данным, известным в, вообще говоря,
хаотически расположенных точках. Степень сглаживания (точность восстановления исходных данных)
регулируется параметрами сглаживания, которые, в принципе, можно задавать в каждой точке.



\section{DMM-сплайны}
Приведём определения для интерполяционных и сглаживающих DMM-сплайнов $S(x)$ трёх переменных $\vec x=(x,y,z)$.
Пусть значения $f_i=f(x_i)$ некоторой функции $f(\vec x)=f(x,y,z)$ известны в точках
${\vec x}_i=(x_i,y_i,z_i)$, $i=1,\ldots,N$, некоторой области $\mathbb{R}^3$.
Мы предполагаем, что все точки ${\vec x}_i$ различны. Обозначим ${\cal{P}}_k$ пространство многочленов
\begin{equation} \label{2}
\pi(\vec x)=\sum_{0\le i+j+l\le k} b_{ijl} x^i y^j z^l
\end{equation}
степени $k$. Напомним, что размерность $p$ пространства ${\cal{P}}_k$ определяется формулой
\[
p=\dim {\cal{P}}_k=\frac{(k+1)(k+2)(k+3)}{6}.
\]
Функция
\begin{equation} \label{3}
S(\vec x)=\sum_{i=1}^N \lambda_i r_i^m  \ln^{(1+(-1)^m)/2} r_i + \pi(\vec x),
\end{equation}
где $m\ge 1$ целое число,
\[
r_i=r(\vec x,{\vec x}_i )=\sqrt{(x-x_i)^2+(y-y_i)^2+(z-z_i)^2+R^2},
\]
$\pi\in {\cal{P}}_k$, $k\ge 0$, многочлен степени $k$, $R$ --– вещественное число (параметр Харди) и
коэффициенты $\lambda_i$ удовлетворяют условиям
\begin{equation} \label{4}
\sum_{i=1}^N \lambda_i \pi({\vec x}_i)=0 \quad   \text{для всех } \ \pi\in {\cal{P}}_k,
\end{equation}
называется \emph{DMM-сплайном степени $m$}.

Под степенью DMM-сплайна мы понимаем показатель степени «расстояния» $r_i$ в формуле \eqref{3}.
Такое определение согласуется со степенью сплайна для обычного одномерного сплайна.
Для чётного $m$ формула DMM-сплайна содержит логарифм, а при нечётном --– квадратный корень.
DMM-сплайны степени $m$ могут отличаться степенью полиномиального слагаемого.
Условия \eqref{4} могут быть переписаны в эквивалентном виде
\begin{equation} \label{5}
\sum_{i=1}^N \lambda_i u_j ({\vec x}_i )=0, \quad j=1,\ldots,p,
\end{equation}
где $u_j$ некоторый базис пространства ${\cal{P}}_k$, т.е.
\[
\pi(\vec x)=\sum_{j=1}^p \alpha_j u_j (\vec x).
\]
Заметим, что $D^m$-сплайны и сплайны Дюшона \cite{BezhaevVasilenko01},
а также мультиквадрики Харди и их обобщения \cite{H90} являются частными случаями общей конструкции DMM-сплайна.

Сплайн $S(\vec x)$ называется интерполяционным сплайном, если он удовлетворяет условиям интерполяции
\begin{equation} \label{6}
S({\vec x}_i )=f_i,\quad i=1,\ldots,N.
\end{equation}
Коэффициенты $\lambda_i$, $\alpha_j$ интерполяционного сплайна определяются из системы линейных
$N+p$ уравнений, получаемой из условий \eqref{5}, \eqref{6},
\begin{equation} \label{7}
\vec {A\Lambda}=\vec F,
\end{equation}
где
\[
\vec \Lambda=(\lambda_1,\ldots,\lambda_N,\alpha_1,\ldots,\alpha_p)^T, \quad \vec F=(f_1,\ldots,f_N,0,\ldots,0)^T.
\]
Матрица этой системы имеет вид
\begin{equation} \label{8}
\vec A=\left(
\begin{array}{ll}
\vec B & \vec C\\
{\vec C}^T & \vec 0
\end{array}
\right),
\end{equation}
где $\vec B=(b_{ij})$ квадратная матрица размерности $N\times N$,
$\vec C$ прямоугольная матрица размерности $N\times p$,
символом $\vec 0$ обозначена нулевая матрица размерности $p\times p$.
Элементы матрицы $\vec B$ полностью определены условиями интерполяции \eqref{6}, а именно
\[
b_{ij}=\left\{
\begin{array}{ll}
[r({\vec x}_i,{\vec x}_j)]^m [\ln r({\vec x}_i,{\vec x}_j)]^{(1+(-1)^m)/2} \quad & \text{при} \ i\ne j,\\
|R| & \text{при} \ i=j,
\end{array}
\right.
i,j=1,\ldots,N.
\]
Элементы матрицы $\vec C$ определяются условиями интерполяции \eqref{6} и выбранным базисом
пространства многочленов ${\cal P}_k$.

Вопросы существования и единственности сплайнов общего вида исследовались в работе \cite{RSh13}.

Построение интерполяционного DMM-сплайна сводится к решению системы линейных уравнений
с практически плотной симметрической матрицей, размер которой в основном определяется количеством точек
интерполяции ${\vec x}_i$. Для достаточно больших значений $N$ такая система может быть плохо обусловлена.
Хороший способ улучшения обусловленности состоит в предварительном преобразовании системы координат,
путём отображения области с заданными точками интерполяции на единичный куб в $\mathbb{R}^3$.
С этой же целью вместо представления многочленов $\pi(\vec x)$ в форме \eqref{2}
более удобно использовать формулу
\[
\pi(\vec x)=\sum_{0\le i+j+l\le k} b_{ijl} (x-x_0)^i (y-y_0)^j (z-z_0)^l,
\]
где
\[
x_0=\frac{1}{N} \sum_{i=1}^N x_i, \quad y_0=\frac{1}{N} \sum_{i=1}^N y_i, \quad z_0=\frac{1}{N} \sum_{i=1}^N z_i.
\]
В этом случае мономы
\[
(x-x_0)^i (y-y_0)^j (z-z_0)^l, \quad 0\le i+j+l\le k,
\]
образуют базис $u_j (\vec x)$ в пространстве многочленов ${\cal P}_k$.
Несмотря на то, что матрица \eqref{8} системы \eqref{7} симметрическая,
метод Холецкого использовать нельзя, так как матрица \eqref{8} не является положительно определённой.
Мы используем некоторую модификацию метода Аазена \cite{A71}
для вычисления коэффициентов сплайна, что позволило вдвое уменьшить время построения
сплайна в сравнении с \cite{ABDMPS09}. К тому же эта модификация позволяет контролировать
обусловленность при решении и автоматически определять ситуации когда система \eqref{7}
близка к вырожденной, что будет происходить в случаях не существования и не единственности DMM-сплайна.

Если в заданных значениях $f_i$ присутствуют погрешности, то, как правило, интерполяционные сплайны
практически бесполезны. В таких случаях необходимо строить сглаживающие сплайны.
Сглаживающий DMM-сплайн $S_\rho (\vec x)$ отличается от интерполяционного $S(\vec x)$ тем,
что при его определении условия интерполяции \eqref{6} заменены следующими
\begin{equation} \label{9}
(-1)^{\tilde{m}}\rho\lambda_i+S_\rho ({\vec x}_i )=f_i, \quad i=1,\ldots,N,
\end{equation}
где $\tilde{m}=\lfloor m/2+1\rfloor$ (здесь использован знак целой части числа), $\rho\ge 0$ --– параметр сглаживания.
Тогда коэффициенты сглаживающего сплайна будут находиться из системы \eqref{7}, но с изменённой матрицей
\begin{equation} \label{10}
\vec A=\left(
\begin{array}{ll}
\tilde{\vec B} & \vec C\\
{\vec C}^T & \vec 0
\end{array}
\right)=\left(
\begin{array}{ll}
\vec B +(-1)^{\tilde{m}}\rho \vec I & \vec C\\
{\vec C}^T & \vec 0
\end{array}
\right),
\end{equation}
где $\vec I$ --– единичная матрица. Эта изменённая матрица отличается от матрицы \eqref{8}
для случая интерполяции только элементами главной диагонали, а именно
\[
\tilde{b}_{ii}=|R|+(-1)^{\tilde{m}}\rho, \quad i=1,\ldots,N.
\]

Отметим, хотя сложности и трудности построения интерполяционных и сглаживающих DMM-сплайнов подобны,
однако ненулевой параметр сглаживания улучшает обусловленность системы уравнений.
Мы не обсуждаем вопросы существования и единственности DMM-сплайнов.
Отметим лишь, что степень сплайна $m$ и степень полиномиальной добавки $k$
в случае интерполяции должны удовлетворять неравенству $k\ge \lfloor m/2\rfloor$,
но при сглаживании такое ограничение отсутствует.

Параметр сглаживания регулирует уровень сглаживания данных.
Значение $\rho=0$ соответствует интерполяционному сплайну, т.е.
$S(\vec x)=S_0 (\vec x)$. С увеличением $\rho$ поведение DMM-сплайна становится более гладким,
уменьшаются или даже исчезают осцилляции, но вместе с тем, вообще говоря,
растёт отклонение от исходных данных, сплайн стремится к некоторому многочлену степени $k$.

Наш опыт использования DMM-сплайнов позволяет утверждать, что DMM-сплайны являются мощным
инструментом приближения функций, особенно заданных на хаотическом множестве точек.
Успех применения DMM-сплайнов зависит от корректного выбора параметров $m$, $k$, $R$, $\rho$.
Приведём некоторые рекомендации.

В случае $R=0$ дифференциальные свойства DMM-сплайнов полностью определены их степенью $m$.
При $m=1$ DMM-сплайн непрерывен, но его первые производные не существуют в точках ${\vec x}_i$.
Для сплайнов степени 2 первые производные непрерывны, но вторые не существуют в точках ${\vec x}_i$, и т.п.
Поэтому, если необходимо приближать первые производные, то степень DMM-сплайнов должна быть не меньше 2.
Вместе с тем не рекомендуется использовать сплайны высоких степеней (больше 4),
так как могут возникать значительные осцилляции. Любое ненулевое значение параметра Харди $R$
делает DMM-сплайн бесконечно дифференцируемым, однако для очень маленьких значений $R$
этот эффект становится чисто формальным. Тем не менее, выбором параметра Харди можно существенным
образом изменить поведение сплайна, в то же время нам кажется невозможным в настоящий момент дать
какие-либо конкретные рекомендации по выбору этого параметра.

Степень полиномиальной части $k$ существенно влияет на свойства DMM-сплайн,
особенно на краях области данных и в подобластях с разреженными данными.
Если поведение аппроксимируемой функции в некотором смысле близко к поведению полинома некоторой
конкретной степени $k$, то это значение и нужно выбрать в качестве степени полиномиальной части.
За пределами области данных сплайн будет вести себя как некоторый полином степени $k$.

Мы уже обсуждали вопрос влияния параметра сглаживания на поведение DMM-сплайна.
Добавим, что можно регулировать степень сглаживания индивидуально в каждой точке ${\vec x}_i$.
Для этого достаточно заменить общий параметр $\rho$ в соотношениях \eqref{9}
на индивидуальные параметры $\rho_i$ для каждого $i$.
Ясно, что это не приводит ни к каким усложнениям алгоритма построения сплайна.



\section{Универсальная характеристика}
Вернёмся к построению математической модели универсальной характеристики.
По имеющимся данным мы строим по описанной методике два сглаживающих трёхмерных DMM-сплайна
$\eta(a,n,\varphi)$ и $q(a,n,\varphi)$. Построение пропеллерной характеристики --– это самый
трудоёмкий и одновременно самый ответственный этап математического моделирования.
После завершения этого этапа можно находить промежуточные характеристики при любых углах
поворота лопастей $\varphi$ и решать весь комплекс задач, относящихся к таким характеристикам.
Кроме того, пропеллерная характеристика служит основой для построения универсальной (комбинаторной) характеристики.

Для ускорения и упрощения работы с полученными функциями $\eta(a,n,\varphi)$ и $q(a,n,\varphi)$
мы аппроксимируем их регулярными трёхмерными кубическими сплайнами $S_\eta (a,n,\varphi)$ и $S_q (a,n,\varphi)$
соответственно на прямоугольной сетке $\Delta=\Delta_a\times \Delta_n\times \Delta_\varphi$.
Используются различные варианты интерполяционных и локально-аппроксимационных сплайнов
в разложении по базису из $B$-сплайнов \cite{ZKM80,ZLS85}.
Переход к кубическим сплайнам позволяет без потери точности
приближения исходных данных значительно увеличить скорость дальнейших вычислений.
Отметим, что для нахождения одного значения DMM-сплайна требуется вычислить сумму достаточно сложных слагаемых,
количество которых не меньше числа точек с исходными данными, и поэтому вычислительные
затраты здесь растут при увеличении числа точек, в принципе, неограничено.
Напротив, затраты на вычисление одного значения кубического сплайна не зависят
ни от количества узлов сплайна, ни от числа точек с исходными данными,
и сводятся к выполнению нескольких десятков арифметических операций.

Пропеллерная характеристика \eqref{1} представляет собой семейство поверхностей,
зависящих от параметра $\varphi\in[\varphi_1,\varphi_L]$.
\emph{Универсальной (комбинаторной) характеристикой} ПЛ-турбины называется огибающая
семейства поверхностей \eqref{1} с параметром $\varphi$.

Комбинаторная характеристика является огибающей семейства поверхностей  \eqref{1}
по параметру $\varphi$.
Следовательно, комбинаторная характеристика является поверхностью в плоскости координат
$q$ и $n$.

Универсальная характеристика находится \cite{Zalgaller75} из уравнения
\begin{equation} \label{11}
\frac{\partial q}{\partial a}\frac{\partial\eta}{\partial\varphi}-\frac{\partial q}{\partial\varphi}\frac{\partial\eta}{\partial a}=0, \quad
\varphi\in[\varphi_1,\varphi_L ], \quad  n\in[n_{\min},n_{\max}].
\end{equation}

Решение уравнения \eqref{11} строится в виде набора бикубических сплайнов
\[
\eta_k (\varphi,n), \quad q_k (\varphi,n), \quad a_k (\varphi,n),
\]
где $\eta_k$, $q_k$, $a_k$ --– соответственно комбинаторный КПД, комбинаторный расход
и комбинаторные открытия. Ещё раз подчеркнём, качество комбинаторной характеристики
определяется качеством построенной ранее пропеллерной характеристики.


\section{Пример моделирования}

Авторами создан комплекс программ для построения пропеллерной и комбинаторной характеристик
и опробован на реальных данных энергетических испытаний модельных ПЛ-гидротурбин.


\begin{figure}[t]
 \begin{center}
\begin{minipage}[t]{0.45\textwidth}
 \begin{center}
\includegraphics[width=\textwidth]{r10}
\caption{Пример исходных данных.}
\label{r01}
 \end{center}
\end{minipage}
%\end{figure}
%\
%\begin{figure}[h]
\begin{minipage}[t]{0.45\textwidth}
 \begin{center}
\includegraphics[width=\textwidth]{r20}
\caption{Пример части исходных данных, $\varphi=0$. }
\label{r02}
 \end{center}
\end{minipage}
 \end{center}
\end{figure}


На рис.~\ref{r01} в плоскости переменных ($Q'_I$, $n'_I$) приведены данные испытаний
для углов поворота лопастей -10, -5, 0, 5, 10, 15. Исходный набор данных состоит из 1479 точек.
%
На рис.~\ref{r02} приведены результаты испытаний для одного угла $\varphi=0$.
Точки соответствующие одному значению открытия направляющего аппарата последовательно
соединены отрезками и изображены в плоскости ($n'_I$,$\eta$).

\begin{figure}[t]
 \begin{center}
  \subfloat[$\rho=0.001$]{\includegraphics[width=0.45\textwidth]{r31}}\
  \subfloat[$\rho=0.1$]{\includegraphics[width=0.45\textwidth]{r32}}\\
\caption{Сглаживание исходных данных, $\varphi=0$. }
\label{r03}
 \end{center}
\end{figure}

На рис.~\ref{r03} приведены примеры сглаживания исходных данных для разных значений параметра сглаживания
$\rho=0.001$ и $\rho=0.1$. В плоскости ($n'_I$, $\eta$) изображены линии одинаковых открытий,
значений соответствующих данным для одного угла $\varphi=0$.

\begin{figure}[t]
 \begin{center}
  \subfloat[$\rho=0.001$]{\includegraphics[width=0.45\textwidth]{r41}}\
  \subfloat[$\rho=0.1$]{\includegraphics[width=0.45\textwidth]{r42}}\\
\caption{Пропеллерная характеристика, $\varphi=0$. }
\label{r04}
 \end{center}
\end{figure}


На рис.~\ref{r04} приведён результат моделирования, пропеллерная характеристика для $\varphi=0$
с параметрами сглаживания $\rho=0.001$ и $\rho=0.1$. Изображены изолинии КПД и линии открытий
в плоскости переменных ($Q'_I$, $n'_I$).

\begin{figure}[t]
 \begin{center}
  \subfloat[$\rho=0.001$]{\includegraphics[width=0.45\textwidth]{r51}}\
  \subfloat[$\rho=0.1$]{\includegraphics[width=0.45\textwidth]{r52}}\\
\caption{Универсальная характеристика. }
\label{r05}
 \end{center}
\end{figure}

На рис.~\ref{r05} приведён результат моделирования, универсальная (комбинаторная) характеристика,
для параметров сглаживания $\rho=0.001$ и $\rho=0.1$.
Изображены изолинии КПД и линии открытий в плоскости переменных ($Q'_I$, $n'_I$).

\section{Заключение}
Предложена методика создания математической модели универсальной характеристики
поворотно-лопастной гидротурбины по результатам стендовых энергетических испытаний
модельных турбин. Результаты испытаний, как правило, представляют сильно нерегулярные
хаотически расположенные и зашумлённые данные. Использование DMM-сплайнов позволило
получить достаточно хорошую аппроксимацию пропеллерной универсальной характеристики,
что в свою очередь позволило рассчитать комбинаторную универсальную (главную) характеристику.
Проведено тестирование созданного комплекса программ в том числе на данных, являющимися
реальными результатами энергетических испытаний. Получаемые математические модели
универсальных характеристик были признаны специалистами достаточно адекватными.
В дальнейшем планируется использовать данный комплекс программ для выбора основных
параметров создаваемых натурных рабочих колёс гидротурбин для гидроэлектростанций.


\section{Литература}
\renewcommand{\bibname}{}
\begin{thebibliography}{99}

\bibitem{Orgo78}
    \BibAuthor{Орго\;В.\,М.}
    Основы конструирования и расчёта на прочность гидротурбин. Л.: Машиностроение,
    1978. 224~ с.
\bibitem{Barlit77}
    \BibAuthor{Барлит\;В.\,В.}
    Гидравлические турбины.
    Киев: Вища школа, 1977. 360~с.
\bibitem{Krivchenko83}
    \BibAuthor{Кривченко\;Г.\,И.}
    Гидравлические машины: турбины и насосы.
    М.: Энергоатомиздат, 1983. 320~с.
\bibitem{VM98}
    \BibAuthor{Волков\;Ю.\,С., Мирошниченко\;В.\,Л.}
    \BibTitle{Построение математической модели универсальной характеристики радиально-осевой гидротурбины}~//
    \BibJournal{Сибирский журнал индустриальной математики}. 1998. Т.\,1, \No\,1. С.\,77--88.
\bibitem{BezhaevVasilenko01}
    \BibAuthor{Bezhaev\;A.\,Yu., Vasilenko\,V.\,A.}
    Variational theory of splines.
    New York: Kluwer Academic Publishers, 2001. 280~p.
\bibitem{BKMV13}
    \BibAuthor{Bogdanov\;V.\,V., Karsten\;W.\,V., Miroshnichenko\;V.\,L., Volkov\;Yu.\,S.}
    \BibTitle{Application of splines for determining the velocity characteristic of a medium from a vertical seismic survey}~//
    \BibJournal{Central European Journal of Mathematics}. 2013. Vol.\,11, \No\,4. P.\,779--786.
\bibitem{RSh13}
    \BibAuthor{Роженко\;А.\,И., Шайдоров\;Т.\,С.}
    \BibTitle{О построении сплайнов методом воспроизводящих ядер}~//
    \BibJournal{Сибирский журнал вычислительной математики}. 2013. Т.\,16, \No\,4. С.\,365--376.
\bibitem{H90}
    \BibAuthor{Hardy\;R.\,L.}
    \BibTitle{Theory and applications of the multiquadric-biharmonic method. 20 years of discovery 1968–1988}~//
    \BibJournal{Computers \& Mathematics with Applications}. 1990. Vol.\,19, \No\,8-9. P.\,163--208.
\bibitem{ABDMPS09}
    \BibAuthor{Anikonov\;Yu.\,E., Bogdanov\;V.\,V., Derevtsov\;E.\,Yu., Miroshnichenko\;V.\,L., Pivovarova\;N.\,B., Slavina\;L.\,B.}
    \BibTitle{Some approaches to a numerical solution for the multidimensional inverse kinematic problem of seismics with inner sources}~//
    \BibJournal{Journal of Inverse and Ill-Posed Problems}. 2009. Vol.\,17, \No\,3. P.\,209--238.
\bibitem{A71}
    \BibAuthor{Aasen\;J.\,O.}
    \BibTitle{On the reduction of a symmetric matrix to tridiagonal form}~//
    \BibJournal{BIT}. 1971. Vol.\,11. P.\,233--242.
\bibitem{ZKM80}
    \BibAuthor{Завьялов\;Ю.\,С., Квасов\;Б.\,И., Мирошниченко\;В.\,А.}
    Методы сплайн-функций.
    М.: Наука, 1980. 352~с.
\bibitem{ZLS85}
    \BibAuthor{Завьялов\;Ю.\,С., Леус\;В.\,А., Скороспелов\;В.\,А.}
    Сплайны в инженерной геометрии.
    М.: Машиностроение, 1985. 221~с.
\bibitem{Zalgaller75}
    \BibAuthor{Залгаллер\;В.\,А.}
    Теория огибающих.
    М.: Наука, 1975. 104~с.
\end{thebibliography}


\section{References}
\renewcommand{\bibname}{}
\begin{thebibliography}{99}
\bibitem{Orgo78}
    \BibAuthor{Orgo\;V.\,M.}\, 1978.
    Design principles and strength design of hydraulic turbines.
    Leningrad:~Mashinostroenie. 224~p. (in Russian)
\bibitem{Barlit77}
    \BibAuthor{Barlit\;V.\,V.}\, 1977.
    Hydraulic turbines.
    Kiev:~Vishcha Shkola. 360~p. (in Russian)
\bibitem{Krivchenko83}
    \BibAuthor{Krivchenko\;G.\,I.}\, 1983.
    Hydraulic machines: turbines and pumps.
    Moscow:~Energoatomizdat. 320~p. (in Russian)
\bibitem{VM98}
    \BibAuthor{Volkov\;Yu.\,S., Miroshnichenko\;V.\,L.}\, 1988.
    \BibTitle{Constructing a mathematical model of a universal characteristic for a radial-axial hydroturbine.}
    \BibJournal{Sibirskij Zhurnal Industrial’noj Matematiki}. 1(1):\,77--88. (in Russian)
\bibitem{BezhaevVasilenko01}
    \BibAuthor{Bezhaev\;A.\,Yu., Vasilenko\,V.\,A.}\, 2001.
    Variational theory of splines.
    N.Y.: Kluwer Academic Publishers. 280~p.
\bibitem{BKMV13}
    \BibAuthor{Bogdanov\;V.\,V., Karsten\;W.\,V., Miroshnichenko\;V.\,L., Volkov\;Yu.\,S.}\, 2013.
    \BibTitle{Application of splines for determining the velocity characteristic of a medium from a vertical seismic survey.}
    \BibJournal{Central European Journal of Mathematics}.  11(4):\,779--786.
\bibitem{RSh13}
    \BibAuthor{Rozhenko\;A.\,I., Shaidorov\;T.\,S.}\, 2013.
    \BibTitle{On spline approximation with a reproducing kernel method.}
    \BibJournal{Numerical Analysis and Applications}. 6(4):\,314--323.
\bibitem{H90}
    \BibAuthor{Hardy\;R.\,L.}\, 1990.
    \BibTitle{Theory and applications of the multiquadric-biharmonic method. 20 years of discovery 1968–1988.}
    \BibJournal{Computers \& Mathematics with Applications}.  19(8-9):\,163--208.
\bibitem{ABDMPS09}
    \BibAuthor{Anikonov\;Yu.\,E., Bogdanov\;V.\,V., Derevtsov\;E.\,Yu., Miroshnichenko\;V.\,L., Pivovarova\;N.\,B., Slavina\;L.\,B.}\, 2009.
    \BibTitle{Some approaches to a numerical solution for the multidimensional inverse kinematic problem of seismics with inner sources.}
    \BibJournal{Journal of Inverse and Ill-Posed Problems}. 17(3):\,209--238.
\bibitem{A71}
    \BibAuthor{Aasen\;J.\,O.}\, 1971.
    \BibTitle{On the reduction of a symmetric matrix to tridiagonal form}
    \BibJournal{BIT}. 11:\,233--242.
\bibitem{ZKM80}
    \BibAuthor{Завьялов\;Ю.\,С., Kvasov\;B.\,I., Miroshnichenko\;V.\,L.}\, 1980.
    Methods of spline-functions.
    Moscow:~Nauka. 352~p. (in Russian)
\bibitem{ZLS85}
    \BibAuthor{Zav'yalov\;Yu.\,S., Leus\;V.\,A., Skorospelov\;V.\,A.}\, 1985.
    Splines in engineering geometry.
    Moscow:~Mashinostroenie. 221~p. (in Russian)
\bibitem{Zalgaller75}
    \BibAuthor{Zalgaller\;V.\,А.}\, 1975.
    Theory of envelopes. Moscow:~Nauka. 104~p. (in Russian)
\end{thebibliography}

% Решение Программного Комитета:
%\ACCEPTNOTE
%\AMENDNOTE
%\REJECTNOTE
\end{document}
