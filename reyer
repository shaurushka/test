\documentclass[12pt, twoside]{article}
\usepackage{jmlda}
\setcounter{page}{1354}

\title[Связность базового скелета и параметрический дескриптор формы]
    {Связность базового скелета и параметрический дескриптор формы}
\author{К.\,В. Жукова, И.\,А. Рейер}
\thanks{Работа выполнена при финансовой поддержке РФФИ, проекты \No\,\No\,11-07-00462 и 14-07-00736.}
\email{kz@pisem.net,reyer@forecsys.ru}
\organization{Москва, Вычислительный центр РАН}
\abstract{
Рассматривается изменение с ростом точности аппроксимации устойчивого скелетного представления формы~--- базового скелета. Этот процесс моделируется стиранием ребер определенными парами кривых. При этом базовый скелет может разделиться на несколько связных компонент. Монотонность и непрерывность изменения позволяют рассматривать параметрическое семейство базовых скелетов и строить масштабируемую гранично-скелетную модель формы, описывающую свойства границы при разных степенях детализации. Для анализа свойств формы, проявляющихся при различных значениях точности, используется параметрический дескриптор, представляющий собой множество вершин выпуклых углов границы аппроксимирующей объект многоугольной фигуры с~определенной оценкой значимости.
В работе представлено обобщение алгоритма вычисления оценок значимости выпуклых особенностей для случаев нарушения связности базового скелета и исследуется возможность использования параметрического дескриптора для различных типов нарушения связности.

\bigskip
\textbf{Ключевые слова}: анализ формы; скелетное представление; базовый скелет; параметрический дескриптор формы
}
\titleEng
    {Skeleton base connectivity and parametric shape descriptor}
\authorEng
    {K.\,V. Zhukova and I.\,A. Reyer}
\organizationEng
    {Dorodnicyn Computing Centre of RAS, Moscow, Russia}
\abstractEng
    {A skeleton base connectivity is described. A skeleton base is a stable shape representation constructed with the use of a polygonal figure approximating the shape. The change of a skeleton base with the growth of the approximation accuracy value is modeled by erasing of edges of the skeleton by pairs of curves. The composition and location of erasing curves is defined by the boundary elements generating an edge, a certain subset of convex boundary vertices, and the accuracy value. A skeleton markup is a set of points of skeleton corresponding to essential changes of the skeleton base's structure. A skeleton markup defines a marked skeleton, in which every edge is erased by a unique pair moving in one direction. A skeleton markup may have points where the skeleton base's connectivity changes. Monotonic and continuous change of a skeleton base allows one to examine the family of skeleton bases and to construct a variously detailed boundary-skeleton shape model. An analysis of this family allows one to calculate significance estimations for curvature features generated by convex vertices of the polygon's boundary. The set of convex vertices with their significance estimations is used as a shape descriptor. In the paper, a generalization of the procedure of curvature features significance estimation for the cases of changes of skeleton base's connectivity is proposed.
			
    \textbf{Keywords}: \emph{shape analysis; skeletal shape representation; skeleton base; parametric shape descriptor}}


\begin{document}
\maketitle

%\linenumbers
\section {Введение}
В задачах машинного зрения часто требуется проводить классификацию объектов по их признакам. Одной из основных характеристик формы объекта, которую можно использовать в качестве признакового описания, является граница объекта. Установлено, что человеческий глаз анализирует форму объекта, опираясь на выпуклости и вогнутости границы. Таким образом, граница отражает особенности формы и делает возможным поиск, основанный на сходстве. Для нахождения особенностей границы используются различные методы, например, методы представления контуров в виде последовательности особенностей-примитивов (выпуклостей и вогнутостей)~\cite{rosin, galton}. При аппроксимациях объекта с различной точностью особенности формы будут проявляться в соответствии со своей значимостью~--- чем более ярко выражена особенность, тем дольше она сохраняется при уменьшении точности аппроксимации. Поэтому, помимо нахождения особенностей, нужно получить оценку значимости каждой особенности границы. Таким образом, возникает задача построения такого дескриптора формы, который содержит информацию об особенностях формы объекта на заданном уровне аппроксимации. Один из подходов для решения такой задачи представляют собой методы <<обнаружения углов>> (corner detection) \cite {koplowitz,ray03}. Идея этих методов состоит в отборе точек локальных экстремумов границы по пороговому значению. Оценкой значимости особенности здесь является абсолютная величина кривизны фрагмента границы, соответствующего этой особенности, поэтому для каждого уровня аппроксимации нужно проводить вычисления этих величин.


Другим популярным инструментом является масштабируемая модель кривизны границы (curvature scale space)~\cite{dudek97, abbasi99}, которая основана на аппроксимации границы кусочно-гладкой кривой, сглаживании этой кривой и выявлении экстремумов или нулей кривизны границы при разных степенях сглаживания.


Описанные подходы для анализа особенностей границы используют понятие кривизны границы, поэтому для реализации этих методов нужно либо применять дискретные модели кривизны, либо аппроксимировать границу кривыми высших порядков. Эта необходимость является недостатком существующих методов.
  
	
Для решения поставленной задачи мы используем параметрическое семейство гранично-скелетных моделей формы, строящихся на основе аппроксимирующей объект многоугольной фигуры \cite{mest09} и состоящих из базового скелета фигуры~\cite{mest03,zhukova09} и границы объединения множества базовых кругов.
С ростом величины точности аппроксимации базовый скелет монотонно и непрерывно изменяется (в смысле расстояния Хаусдорфа) \cite{zhukova12}. Анализируя изменение моделей при росте величины точности аппроксимации, для каждой вершины выпуклого угла аппроксимирующего многоугольника можно получить оценку значимости~--- минимальную величину точности, при которой соответствующая вершине особенность границы исключается из граничного описания. Полученный набор вершин выпуклых углов многоугольной фигуры с сопоставленными им величинами точности аппроксимации мы используем в качестве дескриптора формы.	

При исследовании характера изменения базового скелета возможны ситуации, когда базовый скелет перестает быть связным, начиная с некоторого значения точности. В данной работе рассмотрены возможные варианты нарушения связности и сформулированы правила вычисления дескриптора для них.

\section{Базовый скелет и дескриптор формы}

Введем основные определения и обозначения. Пусть $P$ "--- односвязная многоугольная фигура, $\varepsilon$ "--- некоторое неотрицательное число.

\begin{Def}
Скелетом фигуры $P$ называется множество центров всех ее максимальных пустых кругов.
\end{Def}
\begin{Def}
Круг $C$ называется $\varepsilon$-допустимым кругом для $P$, если существует круг $C'$ из множества максимальных пустых кругов $P$ такой, что $H(C',C' \bigcup C)\leq \varepsilon$.
\end{Def}
\begin{Def}
Круг $C$ называется максимальным
$\varepsilon$-допустимым кругом для $P$, если:

1) $C$ является $\varepsilon$-допустимым кругом для $P$;

2) $C$ не содержится целиком ни в каком другом
$\varepsilon$-допустимом для $P$ круге.
\end{Def}

\begin{figure}[h]
  \centering
   \includegraphics[width=6.5cm]{def.eps}
  \caption{Базовый скелет}
  \label{i1}
\end{figure}

Пусть $C$ -- максимальный $\varepsilon$-допустимый круг для $P$. Точки, в которых соответствующий максимальный пустой круг $C'$ касается границы фигуры, разбивают границу на  фрагменты  $P_1,P_2,\dots,P_n$, $n\geq2$, а радиусы круга $C$, проходящие через эти точки, разбивают окружность круга $C$ на дуги  $L_1, L_2,\dots, L_n$ (рис.\ref {i1}).

\begin{Def}\label{bc}
Максимальный $\varepsilon$-допустимым круг $C$ называется базовым кругом для многоугольной фигуры $P$, если 
$\exists i,j: i\neq j, 1\leq i\leq n, 1\leq j\leq n$ такие, что $H(P_i,L_i)\geq \varepsilon$ и~$H(P_j,L_j)\geq \varepsilon$.
\end{Def}

\begin{Def}
Базовым скелетом $S_{base}(P,\varepsilon)$ многоугольной фигуры $P$ называется множество центров всех базовых кругов области.
\end{Def}

Нетрудно видеть, что базовый скелет $P$ является подмножеством скелета $P$.

Обозначим $U_i$, $i=1,\dots,n$  "--- подмножества вершин границы, принадлежащих фрагментам, на которые разбивается граница точками касания круга $C'$. Пусть $d_i$ максимальное расстояние от центра круга до точек из множества $U_i$. Упорядочим расстояния $d_i$, $i=1,\dots,n$, по возрастанию:
$$d_{1} \leq d_{2} \leq \dots \leq d_{n-1} \leq d_{n},$$
и выберем такое подмножество $U_j$, что соответствующее расстояние $d_j$ является вторым по величине. 
%Если таких подмножеств несколько, рассмотрим любое из них. Если же $d_{1} = d_{2} = \dots = d_{n-1} = d_{n}$, то выберем любое из подмножеств $U_i$.  
Выбранное подмножество вершин границы обозначим $U'$, а наиболее удаленную от центра круга точку $U'$ будем обозначать $f$.

В работе \cite{zhukova12} показано, что базовый скелет при росте $\varepsilon$ измененяется монотонно и~непрерывно в смысле расстояния Хаусдорфа. Данный процесс моделируется <<стиранием>> ребер скелета парами кривых "--- парабол и гипербол (рис. \ref {i2}). Для ребра, порожденного парой сегментов границы, стирающими кривыми являются параболы с фокусом в~точке~$f$ множества $U'$ и директрисами, параллельными порождающим ребро сегментам границы. Ребро, порожденное парой вершин границы, стирают две гиперболы с фокусами в точке $f$ и одной из порождающих ребро вершин. В~случае ребра, порожденного вершиной и~сегментом границы, стирающие  кривые~--- парабола с фокусом в~точке~$f$ и директрисой, параллельной сегменту границы, и гипербола с фокусами в точке $f$ и вершине границы. 
\begin{figure}[h]
  \centering
   \includegraphics[width=14cm]{process.eps}
  \caption{Стирание кривыми ребра: (а) порожденного парой сегментов границы; (б) порожденного вершиной и сегментом границы; (в) порожденного парой вершин границы}
  \label{i2}
\end{figure} 

Очевидно, что пара стирающих кривых не всегда является постоянной для ребра скелета. Во-первых, на ребре могут находиться точки, в которых происходит смена дальней точки $f$ в пределах множества $U'$ (точки пересечения ребра с диаграммой Вороного дальней точки для $U'$). Во-вторых, возможны ситуации, когда для разных фрагментов ребра множество $U'$ различно: смена множества происходит в так называемых центральных точках, равноудаленных от точек $f$ нескольких фрагментов границы. Кроме того, ветви пары кривых могут стирать в противоположных направлениях два соседних фрагмента ребра, имеющих общую точку, в которой одна из кривых касается ребра, а вторая кривая вырождается в луч. Все такие внутренние точки ребер, в которых происходит изменение пары стирающих кривых или направления стирания (точки пересечения с диаграммой дальности Вороного, центральные точки, точки касания), вместе с исходными вершинами скелетного графа образуют разметку \cite{zhukova12}, в которой для каждого ребра скелета однозначно определена пара стирающих кривых и направление стирания (рис. \ref{markup}).

\begin{figure}[h]
  \centering
   \includegraphics[width=14.0cm]{lightning.eps}
  \caption{Разметка скелетного графа}
  \label{markup}
\end{figure} 

Процесс стирания начинается с терминальных вершин скелета и монотонно и непрерывно продолжается <<вглубь>> фигуры с ростом значения точности $\varepsilon$. Это значит, что для фигуры опеределено параметрическое семейство базовых скелетов. При этом дуга базовой окружности с центром в терминальной вершине базового скелета аппроксимирует с~известной точностью соответствующий участок границы. Поэтому границу объединения множества всех базовых кругов можно рассматривать в качестве модели контура фигуры, отражающей те свойства границы, которые являются существенными для данной точности аппроксимации (рис. \ref{descr}).
%При этом из базового скелета «выпадают» ветви, которые порождены выпуклостями границы, несущественными при данной точности аппроксимации.
%Чем дольше сохраняется ребро в базовом скелете, тем более высокую оценку значимости имеет соответствующая особенность. 
Таким образом, анализируя изменение гранично-скелетных моделей формы, можно оценить значимость особенностей (чем существеннее особенность, тем дольше она сохраняется в модели формы) и построить параметрический дескриптор, который представляет собой набор выпуклых вершин границы с определенной оценкой значимости. 

\begin{figure}[h]
  \centering
   \includegraphics[width=17.0cm]{mousfly_model.eps}
  \caption{Параметрическое семейство моделей формы}
  \label{descr}
\end{figure}

Рассмотрим <<идеальный>> случай, когда в базовом скелете нет точек нарушения связности и стирание заканчивается в центральной точке (рис. \ref{go1}). Заметим, что выпуклые вершины границы являются терминальными вершинами скелета фигуры, поэтому далее для удобства будем говорить о вычислении оценок значимости для терминальных вершин скелета. Идею вычисления дескриптора можно описать, проведя аналогию с соревнованиями по бегу: из каждой терминальной вершины одновременно стартуют бегуны. В вершинах, в которые прибегают несколько участников (т.\,е.\ в вершинах скелета степени больше двух), тот, кто прибежал раньше остальных, останавливается и выбывает из гонки, а~значение точности в этой вершине присваивается соответствующей исходной терминальной	вершине в качестве оценки значимости. Тот же, кто прибежал в вершину последним, продолжает двигаться дальше. 
Заканчивается соревнование, когда все оставшиеся бегуны встречаются в центральной точке. Количество бегунов, добежавших до центральной точки, равно степени этой вершины в размеченном скелетном графе.

Опишем алгоритм вычисления оценок значимости более формально. 
Двигаемся от терминальных вершин по направлению стирания, запоминая значение точности в вершине. Если значение в вершине для текущего входящего (по направлению стирания) ребра не является максимальным из всех входящих ребер, то процесс останавливается и это значение присваивается исходной терминальной вершине в качестве оценки значимости. Таким образом, входящие ребра определяют, для каких терминальных вершин процесс вычисления оценки закончен, а для какой продолжится дальше. Исходящие ребра определяют дальнейшее направление. Продолжаем двигаться по ребрам, пока не окажемся в центральной точке, у которой нет исходящих ребер. Значение точности в ней будет максимально и дуги базовой окружности в центром в этой точке будут аппроксимировать соответствующие фрагменты границы фигуры. 

\begin{figure}[h]
  \centering
   \includegraphics[width=11.0cm]{figure4.eps}
  \caption{Построение путей для терминальных вершин}
  \label{go1}
\end{figure}

Для каждой терминальной вершины скелета $p$ будем строить путь из вершин размеченного скелета, упорядоченных по направлению стирания: $\Pi(p) =\left\{ q_1^{\varepsilon^1},\ldots,q_k^{\varepsilon^k} \mid \varepsilon^i =\max\left\{\varepsilon, \varepsilon \in E(q_i)\right\}\right\}$, где $E(q)=\left\{\varepsilon_1,\ldots,\varepsilon_{n-1}\right\}$~--- набор значений $\varepsilon$ вершины $q$, при которых стираются входящие в $q$ ребра. Обозначим через $\Upsilon(p)=\left\{\varepsilon^1,\ldots,\varepsilon^k\right\}$ --- соответствующую последовательность значений точности. Очевидно, что эта последовательность возрастающая. За оценку значимости вершины $p$ принимается максимальный (т.\,е.\ последний) элемент из $\Upsilon(p)$:
\begin{equation}
\Psi(p)= \max\left\{\varepsilon^i \mid \varepsilon^i \in \Upsilon(p) \right\}\,. 
\end{equation}

Таким образом, каждой терминальной вершине $p$ соотвествует упорядоченная последовательность вершин размеченного скелета $\Pi(p)$. На рис. \ref{go1} приведен пример построения путей для вершин фигуры.
	

Более сложные ситуации возникают, если в разметке скелетного графа присутствуют точки нарушения связности: при некотором значении точности из такой точки начинается стирание ребра в противоположных направлениях и базовый скелет разделяется на две части. Опишем, как и в каких случаях это происходит.  

\section{Точки нарушения связности}
\paragraph{Нарушение связности в точках пересечения ребер скелета с ребрами диаграммы Вороного дальней точки.}
Рассмотрим фрагмент фигуры на рис. \ref{mar_img306}а.

\begin{figure}[h]
  \centering
   \includegraphics[width=14.5cm]{break.eps}
  \caption{Нарушение связности в точке пересечения ребра скелета с ребром диаграммы Вороного дальней точки (а,б)}
  \label{mar_img306}
\end{figure}

На ребре $v_1v_2$ находится точка $q$, в которой ребро пересекается с ребром диаграммы Вороного дальней точки для соответствующего множества вершин границы и происходит смена стирающей кривой. Эта точка равноудалена от вершин $a$ и $b$ границы. Стирающими кривыми для ребра $v_1v_2$ являются две пары парабол: $(R_a,Q_a)$ для части ребра $qv_1$ и~$(R_b,Q_b)$ для части ребра $qv_2$. При некотором значении точности все четыре параболы будут пересекаться в точке $q$, а при дальнейшем увеличении значения $\varepsilon$ две пары парабол будут стирать ребро в разных направлениях, т. е. в точке $q$ произойдет нарушение связности (рис.~\ref{mar_img306},\,б).

\paragraph{Нарушение связности в точке касания ребра и стирающей кривой.}
Рассмотрим случай, когда оба элемента, порождающие ребро скелета, являются сегментами (рис.~\ref{mar_img313}). При $\varepsilon<\varepsilon_*$ стирающие параболы не пересекают ребро. При достижении точностью значения $\varepsilon_*$ одна из парабол касается ребра, а вторая вырождена и представляет собой луч. При последующем увеличении $\varepsilon$ в точке касания происходит нарушение связности и ребро стирается параболами в противоположных направлениях. Значение $\varepsilon_*$ в точке касания равно половине расстояния от точки $f$ до сегмента границы, определяющего вырожденную параболу. 


\begin{figure}[h]
  \centering
   \includegraphics[width=10cm]{cont2.eps}
  \caption{Нарушение связности в точке касания ребра и стирающей кривой}
  \label{mar_img313}
\end{figure}

\paragraph{Нарушение связности и центральные точки.}
В случае если на ребре есть центральная точка, то возможны три варианта стирания ребра: две пары кривых стирают ребро от концевых точек к центральной точке I~типа; две пары кривых стирают ребро от центральной точки II~типа с нарушением связности к концевым точкам; ребро стирается в одном направлении и при переходе через центральную точку III~типа меняется пара стирающих кривых.   
В случае, когда точка нарушения связности является точкой касания, она также может быть и центральной точкой (II~типа). Рассмотрим фигуру на рис.~\ref{mar_img315}. Точка $z$ лежит на ребре, порожденном парой сегментов границы, и является точкой касания. При некотором значении точности произойдет касание стирающей параболы и ребра в точке $z$ и из нее начнется стирание ребра в противоположных направлениях. Кроме этого, точка $z$ является центральной точкой: она равноудалена от <<дальних>> точек~$f_1$ и~$f_2$ соответствующих множеств $U'_1$ и $U'_2$ вершин границы. Базовый скелет распадается на два фрагмента, стирание каждого из которых  заканчивается в точках $t_1$ и $t_2$ соответственно.

\begin{figure}[h]
  \centering
   \includegraphics[width=14.0cm]{z4.eps}
  \caption{Центральная точка II типа --- точка нарушения связности}
  \label{mar_img315}
\end{figure}

Теперь рассмотрим пример с центральной точкой III типа, в которой стирание не заканчивается и не начинается, но происходит смена множества $U'$ (рис. \ref{z6_1}). После того, как базовый скелет разделяется в точке нарушения связности $z$, стирание продолжается через точку $v$ пересечения с диаграммой Вороного дальней точки и через центральную точку III~типа $c$. При этом при переходе через $c$ меняется пара стирающих кривых (так как меняется множество $U'$ для ребра). В данном примере фрагмент скелета, содержащий точку $t_1$ исчезнет раньше, чем фрагмент с~$t_2$, и останется только часть скелета, которая соответствует особенности $f_2$, а для особенности $f_1$ уже не будет соответствующих ветвей скелета. Это означает, что в получившейся модели формы дуга базовой окружности с~центром в терминальной вершине аппроксимирует только часть границы фигуры, а для оставшегося фрагмента границы нет аппроксимирующей его дуги базовой окружности. 
\begin{figure}[h]
  \centering
   \includegraphics[width=6.0cm]{z6_1.eps}
  \caption{Центральная точка III типа}
  \label{z6_1}
\end{figure}

На рис. \ref{br_descr3} приведены еще два примера, когда в результате остается часть скелета, соответствующая только одной особенности. Для фигуры, изображенной на рис.~\ref{br_descr3},\,а часть скелета, соответствующая особенности $p_1$, исчезнет при достижении кривыми центральной точки I типа $c$, в то время как часть, соответствующая особенности $p_2$, исчезнет позже. На рис.~\ref{br_descr3},\,б приведен пример, в котором отсутствуют точки нарушения связности. Стирание части скелета, соответствующей особенности $p_1$, закончится в центральной точке III~типа $c$, дальше стирание продолжат кривые, относящиеся к особенности $p_2$. 
\begin{figure}[h]
  \centering
   \includegraphics[width=17.0cm]{br_descr3.eps}
  \caption{В модели формы остается только одна особенность: (а) при наличии точки нарушения связности, (б) нарушения связности нет}
  \label{br_descr3}
\end{figure}

В размеченном скелете может быть несколько центральных точек. На рис. \ref{mar_img316} изображена фигура, при стирании скелета которой произойдет нарушение связности в двух точках $z_1$ и $z_2$, в результате чего базовый скелет разделится на три фрагмента. Каждый из этих фрагментов содержит центральную точку I~типа ($c_1, c_2, c_3$), в которой закончится стирание фрагмента. При этом значения точности в центральных точках не совпадают: $\varepsilon_{c_1}<\varepsilon_{c_2}<\varepsilon_{c_3}$. Таким образом, в конце останется только один фрагмент базового скелета, содержащий центральную точку $c_3$ с максимальным значением точности.
\begin{figure}[h]
  \centering
   \includegraphics[width=6.0cm]{s4_3.eps}
  \caption{Несколько точек нарушения связности и центральных точек}
  \label{mar_img316}
\end{figure}

\paragraph{Нарушение связности в вершине скелета.}
Итак, нарушение связности возможно в точках пересечения с диаграммой Вороного дальней точки, в точках касания для ребер, порожденных парой сегментов границы, и в центральных точках II типа. Помимо этого, точкой нарушения связности может оказаться и вершина скелета, которая не относится ни к какому из перечисленных выше типов точек разметки. Рассмотрим пример на рис. \ref{simple_break}: в вершине $q$ происходит нарушение связности и ребра, выходящие из вершины $q$, стираются парами кривых, порожденными одной точкой $f$. Отметим, что в этом случае в стирании участвуют три параболы, так как исходящие из $q$ ребра имеют общий порождающий сегмент границы. 

\begin{figure}[h]
  \centering
   \includegraphics[width=11cm]{simple_break.eps}
  \caption{Нарушение связности в вершине скелета}
  \label{simple_break}
\end{figure}


\section{Нарушение связности и параметрический дескриптор формы}

Рассмотрим пример на рис. \ref{br_descr2}а. Для фрагмента ребра, содержащего точку нарушения связности $z$, множество $U'$ состоит из точек $p_1,p_2,p_3,p_4$. При некотором значении точности из точки нарушения связности $z$ начинается стирание двумя парами кривых. В результате выполнения описанного выше алгоритма построения дескриптора стирание одного фрагмента скелета начнется из точки $p_2$ и закончится в точке $t$, а оценка значимости вершины $p_2$ $\Psi(p_2)=\varepsilon_t$. Для другой части фигуры стирание начнется из точки $p_6$ и закончится в центральной точке $c$, оценка значимости вершины $p_6$ $\Psi(p_6)=\varepsilon_c$. 
\begin{figure}[h]
  \centering
   \includegraphics[width=10.0cm]{model.eps}
  \caption{Стирание в случае нарушения связности и модели формы}
  \label{br_descr2}
\end{figure}
Рассмотрим модель фигуры для некоторой точности $\varepsilon$, такой, что $\varepsilon_z<\varepsilon<\varepsilon_t$, т.\,е.\ при которой в базовом скелете уже произошло нарушение связности, но еще присутствует ребро с точкой $t$ (рис.~\ref{br_descr2},\,б). Эта модель состоит из двух компонент, одна из которых аппроксимирует фрагмент границы $p_1p_2p_3p_4$, при этом оценка значимости этой особенности равна $\Psi(p_2)$. Однако при точности $\varepsilon>\varepsilon_t$ в модели останется одна компонента (рис.~\ref{br_descr2},\,в) и можно видеть, что в ней есть дуга базовой окружности, аппроксимирующая особенность $p_1p_2p_3p_4$ и, значит, оценка значимости этой особенности больше, чем $\varepsilon_t$. Поэтому при построении дескриптора нужно учитывать и ребра, содержащие точки нарушения связности. Адаптируем алгоритм построения дескриптора для случаев с нарушением связности.

Вернемся к примеру с соревнованиями по бегу. Будем считать, что в момент нарушения связности из точки $z$ стартуют два бегуна в противоположных направлениях.  Один из них продолжит бежать к центральной точке $c$, а второй отправится в точку $t$ и сообщит спортсмену, прибежавшему в $t$ из вершины $p_2$, о том, что за него продолжает соревнование первый бегун из точки $z$. Таким образом, для вершины $p_2$ нужно следить за результатами двух бегунов и в конце соревнования выбрать того, кто прибежит позднее. 

Для каждой вершины $p$ будем строить путь $\Pi(p)$ в размеченном скелетном графе. При прохождении ребра помечаем его как <<пройденное>>. Построение пути прекращается, если выполнено одно из условий:

	(1) значение $\varepsilon$ для текущего входящего в вершину $q$ ребра не максимально из значений всех входящих в $q$ ребер;  
	
	(2) $q$ является центральной точкой с максимальным значением $\varepsilon$ из значений всех центральных точек;  
	
	(3) количество исходящих из $q$ ребер не равно 1. \\

Алгоритм состоит из четырех шагов:

Шаг 1. Для каждой терминальной вершины $p$ строим путь $\Pi(p)$. При этом по\-стро\-ение пути для $p$ завершено, если $\Pi(p)$ заканчивается по условиям (1) или (2). Обозначим множество <<недостроенных>> путей $\overline{\Pi}$.

Шаг 2. Если есть точки нарушения связности, то останутся непройденные ребра (по крайней мере, выходящие из точки нарушения связности). Из каждой точки нарушения связности $q$ строим выходящие из нее два пути $\Pi^1(q)$ и $\Pi^2(q)$, используя только непройденные ребра и прекращая построение, если выполнено одно из условий (1), (2), (3). Обозначим множество таких пар путей $Z=\left\{(\Pi^1(q), \Pi^2(q))\right\}$.

Шаг 3. Для каждого недостроенного пути $\Pi(p)$ из $\overline{\Pi}$ ищем среди пар из $Z$ такую пару $(\Pi^1(q_k), \Pi^2(q_k))$, один из путей которой $\Pi^i(q_k), i=1,2$ заканчивается в последней вершине $\Pi(p)$, и добавляем к пути $\Pi(p)$ вершины $\Pi^i(q_k)$ в обратном направлении, а также вершины второго пути пары $\Pi^j(q_k)$, $i,j=1,2, i\neq j$. Найденная пара удаляется из множества $Z$. Если последняя вершина в полученном пути $\Pi(p)$ удовлетворяет условию (1) или (2), то построение пути завершено и он удаляется из множества  $\overline{\Pi}$.

Повторяем шаг 3, пока множество $Z$ не пусто. 

Шаг 4. Назначение оценок вершинам. За оценку значимости вершины $p$ принимаем максимальное значение точности из значений вершин построенного для $p$ пути $\Pi(p)$.

\begin{figure}[h]
  \centering
   \includegraphics[width=8.0cm]{model2.eps}
  \caption{Построение путей в случае нарушения связности}
  \label{go3}
\end{figure}

Вернемся к фигуре на рис.~\ref{br_descr2}. Для вершин $p_1,p_3,p_4,p_5$ и $p_7$ пути состоят из двух вершин скелета -- терминальной и другой концевой вершиной соответствующего терминального ребра (обозначены прерывистой линией на рис. \ref{go3}). Для вершины $p_6$ путь $\Pi(p_6)$ состоит из вершин скелета от $p_6$ до центральной точки $c$. Оценкой значимости $p_6$ является значение точности в $c$: $\Psi(p_6)=\varepsilon_c$. Для вершины $p_2$ путь $\Pi(p_2)$ состоит из вершин скелета от $p_2$ до $c$, причем вершины фрагмента скелета от точки $z$ до $t$ добавляются в $\Pi(p_2)$ в~направлении, обратном стиранию: от $t$ до $z$. Оценкой значимости вершины $p_2$ является значение точности в точке $c$: $\Psi(p_2)=\varepsilon_c$.

\begin{figure}[h]
  \centering
   \includegraphics[width=15.0cm]{d1.eps}
  \caption{Оценки значимости особенностей форм. Размеры фигур: (а)~$462\times309$; (б)~$495\times495$; (в) $376\times371$; (г)~$442\times445$}
  \label{go5}
\end{figure}

На рис.~\ref{go5} представлен результат работы алгоритма построения дескриптора с вычисленными значениями оценок значимости особенностей границ. 

\section{Выводы}
В работе описаны возможные ситуации нарушения связности базового скелета и представлено обобщение алгоритма вычисления параметрического дескриптора формы для таких случаев. Показано, что в ряде случаев при больших значениях точности можно получить гранично-скелетные модели формы, в которых определнному фрагменту границы не сопоставлено ни одного базового круга с аппроксимирующей этот фрагмент дугой окружности. Таким образом, начиная с некоторого значения точности, полученные модели формы могут, вообще говоря, не быть корректными. Анализ размеченного скелетного графа дает возможность заранее определить, возникнет ли такая ситуация. Вопрос выбора допустимого диапазона значений точности и соответствующего набора моделей форм в конкретной задаче остается на усмотрение исследователя. 

\clearpage
\section{Литература}
\renewcommand{\bibname}{}
\begin{thebibliography}{99}

\bibitem{rosin} %1
	\BibAuthor{Rosin\;P.\,L.}
    \BibTitle{Multiscale representation and matching of curves using codons}~//
    {CVGIP: Graphical Models and Image Processing}. 1993. Vol.\,55, no.\,4. P.\,286--310.

\bibitem{galton} %1
	\BibAuthor{Galton\;A., Meathrel\;R.}
    \BibTitle{Qualitative outline theory}~//
   {16th Joint Conference (Internatioanl) on Artificial Intelligence Proceedings}, 1999. Vol.~2. P.~1061--1066. 

    
\bibitem{koplowitz} %3
	\BibAuthor{Koplowitz\;J., Plante\;S.}
    \BibTitle{Corner detection for chain codes curves}~//
    \BibJournal{Pattern Recognition}. 1995. Vol.\,28, no.\,6. P.\,843--852.
    
\bibitem{ray03} %4
    \BibAuthor{Ray\;B.\,K., Pandyan\;R.}
    \BibTitle{ACORD~--– an adaptive corner detector for planar curves}~//
     {Pattern Recognition}, 2003. Vol.\,36. P.\,703--708.

\bibitem{dudek97} %5
    \BibAuthor{Dudek\;G., Tsotsos\;J.\,K.}
    \BibTitle{Shape representation and recognition from mutliscale curvature}~//
{Computer Vision Image Understanding}, 1997. Vol.~68. No.\,2. P.~170-–189.

     
\bibitem{abbasi99} %6
  \BibAuthor{Abbasi\;S., Mokhtarian\;F., Kittler\;J.}
  \BibTitle{Curvature scale space image in shape similarity retrieval}~//
   {MultiMedia Syst.}, 1999. Vol.~7. P.~467-–476.
   
     
\bibitem{mest09} %7
  \BibAuthor{Местецкий\;Л.\,М.}
   Непрерывная морфология бинарных изображений: фигуры, скелеты,  циркуляры.~--- М.:~Физматлит, 2009. 288~с.
   
\bibitem{mest03}
  \BibAuthor{Местецкий\;Л.\,М., Рейер\;И.\,А.}
  \BibTitle{Непрерывное скелетное представление изображения с контролируемой точностью}~//
  \BibJournal{Тр. 13-й Междунар. конф. ГРАФИКОН-2003.}~--- 
  Москва, 2003. С.~246--249.
     
\bibitem{zhukova09}
  \BibAuthor{Жукова\;К.\,В., Рейер\;И.\,А.}
  \BibTitle{Параметрическое семейство гранично-скелетных моделей формы}~//
{Математические методы распознавания образов: 14-я Всеросс. конф.: Сб. докл.}, 2009. С.~346--350.
    
\bibitem{zhukova12}
  \BibAuthor{Жукова\;К.\,В., Рейер\;И.\,А.}
  \BibTitle{Параметрическое семейство базовых скелетов многоугольной фигуры}~//
{Машинное обучение и анализ данных.} 2012. Т.~1. №\,4. С.~391--410.
   
\end{thebibliography}

\section{References}
\renewcommand{\bibname}{}
\begin{thebibliography}{99}

\bibitem{rosin} %1
	\BibAuthor{Rosin\;P.\,L.} 1993.
    \BibTitle{Multiscale representation and matching of curves using codons.}
    \BibJournal{CVGIP: Graphical Models and Image Processing.} 55(4):286--310.

\bibitem{galton} %2
	\BibAuthor{Galton\;A., Meathrel\;R.} 1999.
    \BibTitle{Qualitative outline theory.}
    \BibJournal{16th Joint Conference (international) on Artificial Intelligence Proceedings.} 2:1061--1066.
    

\bibitem{koplowitz}
	\BibAuthor{Koplowitz\;J., Plante\;S.} 1995.
    \BibTitle{Corner detection for chain codes curves.}
    \BibJournal{Pattern Recognition} 28(6):843--852.
    
\bibitem{ray03}
    \BibAuthor{Ray\;B.\,K., Pandyan\;R.}\,2003.
    \BibTitle{ACORD~--– an adaptive corner detector for planar curves.}
    \BibJournal{Pattern Recognition} 36:703--708.

\bibitem{dudek97} %5
    \BibAuthor{Dudek\;G., Tsotsos\;J.\,K.}\,1997.
    \BibTitle{Shape representation and recognition from mutliscale curvature.}
    \BibJournal{Computer Vision Image Understanding} 68(2):170-–189.
    
\bibitem{abbasi99} %6
  \BibAuthor{Abbasi\;S., Mokhtarian\;F., Kittler\;J.}\,1999.
  \BibTitle{Curvature scale space image in shape similarity retrieval.}
  \BibJournal{MultiMedia Syst.} 7:467–-476.
   
     
\bibitem{mest09}
    \BibAuthor{Mestetskii\;L.\,M.} 2009.
    Continuous morphology of binary images: Figures, skeletons and circulars.
    Moscow:~Fizmatlit Publ. 288~p. (In Russian.)
   
\bibitem{mest03}
    \BibAuthor{Mestetskii\;L.\,M., Reyer\;I.\,A.} 2003.
    \BibTitle{Continuous skeletal representation of image with controllable accuracy.}
     \BibJournal{Conference (International) Graphicon Proceedings.} Moscow. 246--249. (In Russian.)
     
\bibitem{zhukova09}
  	\BibAuthor{Zhukova\;K.\,V., Reyer\;I.\,A.} 2009.
  	\BibTitle{Parametric family of boundary-skeletal shape models.}
   	\BibJournal{14th Russian Conference on Mathematical Methods for Pattern Recognition (MMPR-14) Proceedings.} Suzdal. 346--350. (In Russian.)

\bibitem{zhukova12}
  	\BibAuthor{Zhukova\;K.\,V., Reyer\;I.\,A.}, 2012.
  	\BibTitle{Parametric family of skeleton bases of a polygonal figure.}
   	\BibJournal{Machine Learning Data Analysis} 1(4):391--410. (In Russian.)		
   
\end{thebibliography}

\end{document}
      
